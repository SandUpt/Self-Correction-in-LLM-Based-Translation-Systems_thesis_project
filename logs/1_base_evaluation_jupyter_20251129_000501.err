`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                              | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|███████████████████████████                           | 1/2 [00:01<00:01,  1.42s/it]Loading checkpoint shards: 100%|██████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.15it/s]Loading checkpoint shards: 100%|██████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.05it/s]
Generating:   0%|                                                                            | 0/21 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Generating:   5%|███▏                                                                | 1/21 [00:47<15:43, 47.16s/it]Generating:  10%|██████▍                                                             | 2/21 [01:32<14:32, 45.92s/it]Generating:  14%|█████████▋                                                          | 3/21 [02:17<13:40, 45.56s/it]Generating:  19%|████████████▉                                                       | 4/21 [03:02<12:51, 45.41s/it]Generating:  24%|████████████████▏                                                   | 5/21 [03:49<12:17, 46.06s/it]Generating:  29%|███████████████████▍                                                | 6/21 [04:33<11:17, 45.16s/it]Generating:  33%|██████████████████████▋                                             | 7/21 [05:14<10:15, 43.98s/it]Generating:  38%|█████████████████████████▉                                          | 8/21 [05:57<09:28, 43.74s/it]Generating:  43%|█████████████████████████████▏                                      | 9/21 [06:42<08:48, 44.03s/it]Generating:  48%|███████████████████████████████▉                                   | 10/21 [07:24<07:58, 43.48s/it]Generating:  52%|███████████████████████████████████                                | 11/21 [08:06<07:10, 43.02s/it]Generating:  57%|██████████████████████████████████████▎                            | 12/21 [08:53<06:35, 43.99s/it]Generating:  62%|█████████████████████████████████████████▍                         | 13/21 [09:34<05:45, 43.21s/it]Generating:  67%|████████████████████████████████████████████▋                      | 14/21 [10:16<05:00, 42.92s/it]Generating:  71%|███████████████████████████████████████████████▊                   | 15/21 [11:00<04:19, 43.28s/it]Generating:  76%|███████████████████████████████████████████████████                | 16/21 [11:44<03:37, 43.44s/it]Generating:  81%|██████████████████████████████████████████████████████▏            | 17/21 [12:26<02:51, 42.96s/it]Generating:  86%|█████████████████████████████████████████████████████████▍         | 18/21 [13:09<02:08, 42.97s/it]Generating:  90%|████████████████████████████████████████████████████████████▌      | 19/21 [13:57<01:28, 44.41s/it]Generating:  95%|███████████████████████████████████████████████████████████████▊   | 20/21 [14:42<00:44, 44.78s/it]Generating: 100%|███████████████████████████████████████████████████████████████████| 21/21 [15:19<00:00, 42.20s/it]Generating: 100%|███████████████████████████████████████████████████████████████████| 21/21 [15:19<00:00, 43.76s/it]
Fetching 5 files:   0%|                                                                       | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|█████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 2238.16it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 1_base_evaluation.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
