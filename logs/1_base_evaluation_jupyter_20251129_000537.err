`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                   | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██████████████████▊                                                        | 1/4 [00:09<00:28,  9.40s/it]Loading checkpoint shards:  50%|█████████████████████████████████████▌                                     | 2/4 [00:18<00:18,  9.19s/it]Loading checkpoint shards:  75%|████████████████████████████████████████████████████████▎                  | 3/4 [00:27<00:09,  9.23s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:29<00:00,  6.36s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:29<00:00,  7.42s/it]
Generating:   0%|                                                                                                 | 0/21 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Generating:   5%|████▏                                                                                    | 1/21 [00:24<08:01, 24.08s/it]Generating:  10%|████████▍                                                                                | 2/21 [00:46<07:18, 23.05s/it]Generating:  14%|████████████▋                                                                            | 3/21 [01:09<06:57, 23.18s/it]Generating:  19%|████████████████▉                                                                        | 4/21 [01:32<06:29, 22.89s/it]Generating:  24%|█████████████████████▏                                                                   | 5/21 [01:56<06:12, 23.26s/it]Generating:  29%|█████████████████████████▍                                                               | 6/21 [02:18<05:44, 22.95s/it]Generating:  33%|█████████████████████████████▋                                                           | 7/21 [02:40<05:15, 22.56s/it]Generating:  38%|█████████████████████████████████▉                                                       | 8/21 [03:03<04:54, 22.65s/it]Generating:  43%|██████████████████████████████████████▏                                                  | 9/21 [03:25<04:31, 22.62s/it]Generating:  48%|█████████████████████████████████████████▉                                              | 10/21 [03:48<04:08, 22.57s/it]Generating:  52%|██████████████████████████████████████████████                                          | 11/21 [04:09<03:43, 22.34s/it]Generating:  57%|██████████████████████████████████████████████████▎                                     | 12/21 [04:33<03:23, 22.59s/it]Generating:  62%|██████████████████████████████████████████████████████▍                                 | 13/21 [04:54<02:58, 22.34s/it]Generating:  67%|██████████████████████████████████████████████████████████▋                             | 14/21 [05:16<02:35, 22.27s/it]Generating:  71%|██████████████████████████████████████████████████████████████▊                         | 15/21 [05:39<02:14, 22.46s/it]Generating:  76%|███████████████████████████████████████████████████████████████████                     | 16/21 [06:02<01:52, 22.59s/it]Generating:  81%|███████████████████████████████████████████████████████████████████████▏                | 17/21 [06:24<01:29, 22.46s/it]Generating:  86%|███████████████████████████████████████████████████████████████████████████▍            | 18/21 [06:47<01:07, 22.43s/it]Generating:  90%|███████████████████████████████████████████████████████████████████████████████▌        | 19/21 [07:11<00:45, 22.94s/it]Generating:  95%|███████████████████████████████████████████████████████████████████████████████████▊    | 20/21 [07:35<00:23, 23.26s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████| 21/21 [07:55<00:00, 22.19s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████| 21/21 [07:55<00:00, 22.62s/it]
Fetching 5 files:   0%|                                                                                            | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|██████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 4503.23it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 1_base_evaluation.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
