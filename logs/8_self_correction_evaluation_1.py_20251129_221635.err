`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                              | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|█████████████████▌                                                    | 1/4 [00:08<00:25,  8.41s/it]Loading checkpoint shards:  50%|███████████████████████████████████                                   | 2/4 [00:15<00:15,  7.71s/it]Loading checkpoint shards:  75%|████████████████████████████████████████████████████▌                 | 3/4 [00:23<00:07,  7.75s/it]Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████████| 4/4 [00:25<00:00,  5.45s/it]Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████████| 4/4 [00:25<00:00,  6.34s/it]
Generating:   0%|                                                                                           | 0/157 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p', 'top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Generating:   1%|▌                                                                                | 1/157 [00:36<1:35:07, 36.58s/it]Generating:   1%|█                                                                                | 2/157 [01:12<1:32:47, 35.92s/it]Generating:   2%|█▌                                                                               | 3/157 [01:47<1:32:02, 35.86s/it]Generating:   3%|██                                                                               | 4/157 [02:23<1:31:09, 35.75s/it]Generating:   3%|██▌                                                                              | 5/157 [03:00<1:31:27, 36.10s/it]Generating:   4%|███                                                                              | 6/157 [03:35<1:30:34, 35.99s/it]Generating:   4%|███▌                                                                             | 7/157 [04:12<1:30:26, 36.18s/it]Generating:   5%|████▏                                                                            | 8/157 [04:49<1:30:18, 36.36s/it]Generating:   6%|████▋                                                                            | 9/157 [05:25<1:29:41, 36.36s/it]Generating:   6%|█████                                                                           | 10/157 [06:02<1:29:35, 36.57s/it]Generating:   7%|█████▌                                                                          | 11/157 [06:37<1:27:54, 36.13s/it]Generating:   8%|██████                                                                          | 12/157 [07:14<1:27:29, 36.20s/it]Generating:   8%|██████▌                                                                         | 13/157 [07:51<1:27:58, 36.66s/it]Generating:   9%|███████▏                                                                        | 14/157 [08:27<1:26:53, 36.45s/it]Generating:  10%|███████▋                                                                        | 15/157 [09:04<1:26:13, 36.43s/it]Generating:  10%|████████▏                                                                       | 16/157 [09:40<1:25:14, 36.27s/it]Generating:  11%|████████▋                                                                       | 17/157 [10:16<1:24:38, 36.28s/it]Generating:  11%|█████████▏                                                                      | 18/157 [10:52<1:23:59, 36.26s/it]Generating:  12%|█████████▋                                                                      | 19/157 [11:29<1:23:59, 36.52s/it]Generating:  13%|██████████▏                                                                     | 20/157 [12:05<1:23:05, 36.39s/it]Generating:  13%|██████████▋                                                                     | 21/157 [12:41<1:22:20, 36.33s/it]Generating:  14%|███████████▏                                                                    | 22/157 [13:18<1:21:49, 36.37s/it]Generating:  15%|███████████▋                                                                    | 23/157 [13:55<1:21:31, 36.51s/it]Generating:  15%|████████████▏                                                                   | 24/157 [14:31<1:20:34, 36.35s/it]Generating:  16%|████████████▋                                                                   | 25/157 [15:08<1:20:28, 36.58s/it]Generating:  17%|█████████████▏                                                                  | 26/157 [15:44<1:19:27, 36.40s/it]Generating:  17%|█████████████▊                                                                  | 27/157 [16:20<1:18:24, 36.19s/it]Generating:  18%|██████████████▎                                                                 | 28/157 [16:55<1:17:18, 35.96s/it]Generating:  18%|██████████████▊                                                                 | 29/157 [17:31<1:16:36, 35.91s/it]Generating:  19%|███████████████▎                                                                | 30/157 [18:07<1:16:18, 36.05s/it]Generating:  20%|███████████████▊                                                                | 31/157 [18:42<1:15:12, 35.81s/it]Generating:  20%|████████████████▎                                                               | 32/157 [19:18<1:14:36, 35.81s/it]Generating:  21%|████████████████▊                                                               | 33/157 [19:54<1:14:17, 35.95s/it]Generating:  22%|█████████████████▎                                                              | 34/157 [20:31<1:13:53, 36.05s/it]Generating:  22%|█████████████████▊                                                              | 35/157 [21:07<1:13:43, 36.26s/it]Generating:  23%|██████████████████▎                                                             | 36/157 [21:45<1:13:34, 36.48s/it]Generating:  24%|██████████████████▊                                                             | 37/157 [22:21<1:12:43, 36.36s/it]Generating:  24%|███████████████████▎                                                            | 38/157 [22:56<1:11:33, 36.08s/it]Generating:  25%|███████████████████▊                                                            | 39/157 [23:31<1:10:13, 35.70s/it]Generating:  25%|████████████████████▍                                                           | 40/157 [24:07<1:09:46, 35.79s/it]Generating:  26%|████████████████████▉                                                           | 41/157 [24:43<1:09:40, 36.04s/it]Generating:  27%|█████████████████████▍                                                          | 42/157 [25:19<1:08:43, 35.85s/it]Generating:  27%|█████████████████████▉                                                          | 43/157 [25:55<1:08:14, 35.91s/it]Generating:  28%|██████████████████████▍                                                         | 44/157 [26:32<1:08:02, 36.13s/it]Generating:  29%|██████████████████████▉                                                         | 45/157 [27:07<1:07:18, 36.06s/it]Generating:  29%|███████████████████████▍                                                        | 46/157 [27:45<1:07:17, 36.37s/it]Generating:  30%|███████████████████████▉                                                        | 47/157 [28:20<1:06:18, 36.17s/it]Generating:  31%|████████████████████████▍                                                       | 48/157 [28:58<1:06:19, 36.51s/it]Generating:  31%|████████████████████████▉                                                       | 49/157 [29:34<1:05:50, 36.58s/it]Generating:  32%|█████████████████████████▍                                                      | 50/157 [30:12<1:05:34, 36.77s/it]Generating:  32%|█████████████████████████▉                                                      | 51/157 [30:48<1:04:44, 36.65s/it]Generating:  33%|██████████████████████████▍                                                     | 52/157 [31:23<1:03:14, 36.14s/it]Generating:  34%|███████████████████████████                                                     | 53/157 [31:58<1:02:16, 35.92s/it]Generating:  34%|███████████████████████████▌                                                    | 54/157 [32:35<1:01:52, 36.05s/it]Generating:  35%|████████████████████████████                                                    | 55/157 [33:10<1:00:59, 35.88s/it]Generating:  36%|████████████████████████████▌                                                   | 56/157 [33:48<1:01:24, 36.48s/it]Generating:  36%|█████████████████████████████                                                   | 57/157 [34:24<1:00:29, 36.29s/it]Generating:  37%|██████████████████████████████▎                                                   | 58/157 [35:00<59:54, 36.31s/it]Generating:  38%|██████████████████████████████▊                                                   | 59/157 [35:37<59:25, 36.38s/it]Generating:  38%|███████████████████████████████▎                                                  | 60/157 [36:12<58:15, 36.03s/it]Generating:  39%|███████████████████████████████▊                                                  | 61/157 [36:48<57:48, 36.13s/it]Generating:  39%|████████████████████████████████▍                                                 | 62/157 [37:24<57:13, 36.14s/it]Generating:  40%|████████████████████████████████▉                                                 | 63/157 [38:01<56:38, 36.15s/it]Generating:  41%|█████████████████████████████████▍                                                | 64/157 [38:37<56:13, 36.28s/it]Generating:  41%|█████████████████████████████████▉                                                | 65/157 [39:15<56:13, 36.67s/it]Generating:  42%|██████████████████████████████████▍                                               | 66/157 [39:50<55:10, 36.37s/it]Generating:  43%|██████████████████████████████████▉                                               | 67/157 [40:27<54:35, 36.40s/it]Generating:  43%|███████████████████████████████████▌                                              | 68/157 [41:04<54:10, 36.52s/it]Generating:  44%|████████████████████████████████████                                              | 69/157 [41:40<53:16, 36.32s/it]Generating:  45%|████████████████████████████████████▌                                             | 70/157 [42:16<52:37, 36.30s/it]Generating:  45%|█████████████████████████████████████                                             | 71/157 [42:53<52:25, 36.57s/it]Generating:  46%|█████████████████████████████████████▌                                            | 72/157 [43:30<51:46, 36.55s/it]Generating:  46%|██████████████████████████████████████▏                                           | 73/157 [44:06<51:09, 36.54s/it]Generating:  47%|██████████████████████████████████████▋                                           | 74/157 [44:43<50:32, 36.54s/it]Generating:  48%|███████████████████████████████████████▏                                          | 75/157 [45:20<50:20, 36.83s/it]Generating:  48%|███████████████████████████████████████▋                                          | 76/157 [45:57<49:45, 36.86s/it]Generating:  49%|████████████████████████████████████████▏                                         | 77/157 [46:33<48:53, 36.66s/it]Generating:  50%|████████████████████████████████████████▋                                         | 78/157 [47:10<48:09, 36.57s/it]Generating:  50%|█████████████████████████████████████████▎                                        | 79/157 [47:45<47:15, 36.35s/it]Generating:  51%|█████████████████████████████████████████▊                                        | 80/157 [48:21<46:31, 36.25s/it]Generating:  52%|██████████████████████████████████████████▎                                       | 81/157 [48:57<45:47, 36.15s/it]Generating:  52%|██████████████████████████████████████████▊                                       | 82/157 [49:34<45:33, 36.44s/it]Generating:  53%|███████████████████████████████████████████▎                                      | 83/157 [50:12<45:14, 36.68s/it]Generating:  54%|███████████████████████████████████████████▊                                      | 84/157 [50:49<44:57, 36.95s/it]Generating:  54%|████████████████████████████████████████████▍                                     | 85/157 [51:26<44:24, 37.00s/it]Generating:  55%|████████████████████████████████████████████▉                                     | 86/157 [52:02<43:24, 36.68s/it]Generating:  55%|█████████████████████████████████████████████▍                                    | 87/157 [52:40<43:13, 37.05s/it]Generating:  56%|█████████████████████████████████████████████▉                                    | 88/157 [53:16<42:09, 36.65s/it]Generating:  57%|██████████████████████████████████████████████▍                                   | 89/157 [53:52<41:17, 36.43s/it]Generating:  57%|███████████████████████████████████████████████                                   | 90/157 [54:28<40:41, 36.43s/it]Generating:  58%|███████████████████████████████████████████████▌                                  | 91/157 [55:07<40:44, 37.04s/it]Generating:  59%|████████████████████████████████████████████████                                  | 92/157 [55:43<39:52, 36.81s/it]Generating:  59%|████████████████████████████████████████████████▌                                 | 93/157 [56:18<38:43, 36.31s/it]Generating:  60%|█████████████████████████████████████████████████                                 | 94/157 [56:55<38:17, 36.47s/it]Generating:  61%|█████████████████████████████████████████████████▌                                | 95/157 [57:31<37:35, 36.38s/it]Generating:  61%|██████████████████████████████████████████████████▏                               | 96/157 [58:07<36:57, 36.35s/it]Generating:  62%|██████████████████████████████████████████████████▋                               | 97/157 [58:43<36:14, 36.24s/it]Generating:  62%|███████████████████████████████████████████████████▏                              | 98/157 [59:20<35:47, 36.39s/it]Generating:  63%|███████████████████████████████████████████████████▋                              | 99/157 [59:55<34:50, 36.04s/it]Generating:  64%|██████████████████████████████████████████████████▎                            | 100/157 [1:00:32<34:29, 36.30s/it]Generating:  64%|██████████████████████████████████████████████████▊                            | 101/157 [1:01:07<33:33, 35.95s/it]Generating:  65%|███████████████████████████████████████████████████▎                           | 102/157 [1:01:43<32:43, 35.71s/it]Generating:  66%|███████████████████████████████████████████████████▊                           | 103/157 [1:02:19<32:23, 35.99s/it]Generating:  66%|████████████████████████████████████████████████████▎                          | 104/157 [1:02:56<31:57, 36.19s/it]Generating:  67%|████████████████████████████████████████████████████▊                          | 105/157 [1:03:32<31:24, 36.24s/it]Generating:  68%|█████████████████████████████████████████████████████▎                         | 106/157 [1:04:08<30:45, 36.19s/it]Generating:  68%|█████████████████████████████████████████████████████▊                         | 107/157 [1:04:45<30:14, 36.30s/it]Generating:  69%|██████████████████████████████████████████████████████▎                        | 108/157 [1:05:22<29:45, 36.43s/it]Generating:  69%|██████████████████████████████████████████████████████▊                        | 109/157 [1:05:57<28:54, 36.13s/it]Generating:  70%|███████████████████████████████████████████████████████▎                       | 110/157 [1:06:33<28:13, 36.03s/it]Generating:  71%|███████████████████████████████████████████████████████▊                       | 111/157 [1:07:10<27:46, 36.23s/it]Generating:  71%|████████████████████████████████████████████████████████▎                      | 112/157 [1:07:46<27:10, 36.24s/it]Generating:  72%|████████████████████████████████████████████████████████▊                      | 113/157 [1:08:21<26:22, 35.97s/it]Generating:  73%|█████████████████████████████████████████████████████████▎                     | 114/157 [1:08:57<25:48, 36.02s/it]Generating:  73%|█████████████████████████████████████████████████████████▊                     | 115/157 [1:09:34<25:20, 36.21s/it]Generating:  74%|██████████████████████████████████████████████████████████▎                    | 116/157 [1:10:10<24:40, 36.10s/it]Generating:  75%|██████████████████████████████████████████████████████████▊                    | 117/157 [1:10:46<24:06, 36.15s/it]Generating:  75%|███████████████████████████████████████████████████████████▍                   | 118/157 [1:11:22<23:32, 36.21s/it]Generating:  76%|███████████████████████████████████████████████████████████▉                   | 119/157 [1:11:59<22:58, 36.29s/it]Generating:  76%|████████████████████████████████████████████████████████████▍                  | 120/157 [1:12:35<22:21, 36.25s/it]Generating:  77%|████████████████████████████████████████████████████████████▉                  | 121/157 [1:13:11<21:46, 36.29s/it]Generating:  78%|█████████████████████████████████████████████████████████████▍                 | 122/157 [1:13:48<21:13, 36.39s/it]Generating:  78%|█████████████████████████████████████████████████████████████▉                 | 123/157 [1:14:23<20:24, 36.01s/it]Generating:  79%|██████████████████████████████████████████████████████████████▍                | 124/157 [1:14:58<19:36, 35.66s/it]Generating:  80%|██████████████████████████████████████████████████████████████▉                | 125/157 [1:15:34<19:06, 35.83s/it]Generating:  80%|███████████████████████████████████████████████████████████████▍               | 126/157 [1:16:11<18:35, 35.98s/it]Generating:  81%|███████████████████████████████████████████████████████████████▉               | 127/157 [1:16:47<18:07, 36.26s/it]Generating:  82%|████████████████████████████████████████████████████████████████▍              | 128/157 [1:17:23<17:29, 36.17s/it]Generating:  82%|████████████████████████████████████████████████████████████████▉              | 129/157 [1:17:58<16:43, 35.83s/it]Generating:  83%|█████████████████████████████████████████████████████████████████▍             | 130/157 [1:18:34<16:03, 35.68s/it]Generating:  83%|█████████████████████████████████████████████████████████████████▉             | 131/157 [1:19:10<15:35, 35.97s/it]Generating:  84%|██████████████████████████████████████████████████████████████████▍            | 132/157 [1:19:46<14:55, 35.81s/it]Generating:  85%|██████████████████████████████████████████████████████████████████▉            | 133/157 [1:20:22<14:18, 35.78s/it]Generating:  85%|███████████████████████████████████████████████████████████████████▍           | 134/157 [1:20:59<13:54, 36.27s/it]Generating:  86%|███████████████████████████████████████████████████████████████████▉           | 135/157 [1:21:35<13:18, 36.29s/it]Generating:  87%|████████████████████████████████████████████████████████████████████▍          | 136/157 [1:22:12<12:46, 36.48s/it]Generating:  87%|████████████████████████████████████████████████████████████████████▉          | 137/157 [1:22:49<12:11, 36.55s/it]Generating:  88%|█████████████████████████████████████████████████████████████████████▍         | 138/157 [1:23:25<11:33, 36.49s/it]Generating:  89%|█████████████████████████████████████████████████████████████████████▉         | 139/157 [1:24:01<10:50, 36.14s/it]Generating:  89%|██████████████████████████████████████████████████████████████████████▍        | 140/157 [1:24:38<10:17, 36.35s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████▉        | 141/157 [1:25:14<09:44, 36.52s/it]Generating:  90%|███████████████████████████████████████████████████████████████████████▍       | 142/157 [1:25:51<09:07, 36.53s/it]Generating:  91%|███████████████████████████████████████████████████████████████████████▉       | 143/157 [1:26:27<08:31, 36.50s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████▍      | 144/157 [1:27:04<07:54, 36.51s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████▉      | 145/157 [1:27:40<07:16, 36.40s/it]Generating:  93%|█████████████████████████████████████████████████████████████████████████▍     | 146/157 [1:28:17<06:40, 36.44s/it]Generating:  94%|█████████████████████████████████████████████████████████████████████████▉     | 147/157 [1:28:53<06:03, 36.38s/it]Generating:  94%|██████████████████████████████████████████████████████████████████████████▍    | 148/157 [1:29:29<05:27, 36.35s/it]Generating:  95%|██████████████████████████████████████████████████████████████████████████▉    | 149/157 [1:30:06<04:51, 36.40s/it]Generating:  96%|███████████████████████████████████████████████████████████████████████████▍   | 150/157 [1:30:41<04:12, 36.04s/it]Generating:  96%|███████████████████████████████████████████████████████████████████████████▉   | 151/157 [1:31:18<03:38, 36.36s/it]Generating:  97%|████████████████████████████████████████████████████████████████████████████▍  | 152/157 [1:31:55<03:02, 36.47s/it]Generating:  97%|████████████████████████████████████████████████████████████████████████████▉  | 153/157 [1:32:30<02:24, 36.01s/it]Generating:  98%|█████████████████████████████████████████████████████████████████████████████▍ | 154/157 [1:33:06<01:48, 36.26s/it]Generating:  99%|█████████████████████████████████████████████████████████████████████████████▉ | 155/157 [1:33:44<01:13, 36.68s/it]Generating:  99%|██████████████████████████████████████████████████████████████████████████████▍| 156/157 [1:34:20<00:36, 36.55s/it]Generating: 100%|███████████████████████████████████████████████████████████████████████████████| 157/157 [1:34:35<00:00, 30.08s/it]Generating: 100%|███████████████████████████████████████████████████████████████████████████████| 157/157 [1:34:35<00:00, 36.15s/it]
Fetching 5 files:   0%|                                                                                       | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|█████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 5565.69it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
