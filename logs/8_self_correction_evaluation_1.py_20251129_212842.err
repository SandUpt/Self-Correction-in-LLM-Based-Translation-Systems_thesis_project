`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                               | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|█████████████████████▊                                                                 | 1/4 [00:00<00:02,  1.36it/s]Loading checkpoint shards:  50%|███████████████████████████████████████████▌                                           | 2/4 [00:01<00:01,  1.34it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████████████████████████▎                     | 3/4 [00:02<00:00,  1.42it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  2.02it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.73it/s]
Generating:   0%|                                                                                                            | 0/157 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p', 'top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Generating:   1%|▌                                                                                                 | 1/157 [00:35<1:32:16, 35.49s/it]Generating:   1%|█▏                                                                                                | 2/157 [01:11<1:32:05, 35.65s/it]Generating:   2%|█▊                                                                                                | 3/157 [01:45<1:29:52, 35.01s/it]Generating:   3%|██▍                                                                                               | 4/157 [02:21<1:29:50, 35.23s/it]Generating:   3%|███                                                                                               | 5/157 [02:55<1:28:18, 34.86s/it]Generating:   4%|███▋                                                                                              | 6/157 [03:30<1:28:25, 35.14s/it]Generating:   4%|████▎                                                                                             | 7/157 [04:05<1:27:24, 34.96s/it]Generating:   5%|████▉                                                                                             | 8/157 [04:40<1:26:58, 35.02s/it]Generating:   6%|█████▌                                                                                            | 9/157 [05:15<1:26:06, 34.91s/it]Generating:   6%|██████▏                                                                                          | 10/157 [05:50<1:25:19, 34.83s/it]Generating:   7%|██████▊                                                                                          | 11/157 [06:24<1:24:45, 34.83s/it]Generating:   8%|███████▍                                                                                         | 12/157 [06:59<1:24:02, 34.77s/it]Generating:   8%|████████                                                                                         | 13/157 [07:35<1:24:02, 35.02s/it]Generating:   9%|████████▋                                                                                        | 14/157 [08:10<1:23:35, 35.08s/it]Generating:  10%|█████████▎                                                                                       | 15/157 [08:45<1:23:22, 35.23s/it]Generating:  10%|█████████▉                                                                                       | 16/157 [09:19<1:21:49, 34.82s/it]Generating:  11%|██████████▌                                                                                      | 17/157 [09:55<1:22:03, 35.17s/it]Generating:  11%|███████████                                                                                      | 18/157 [10:30<1:21:20, 35.11s/it]Generating:  12%|███████████▋                                                                                     | 19/157 [11:06<1:21:20, 35.37s/it]Generating:  13%|████████████▎                                                                                    | 20/157 [11:41<1:20:22, 35.20s/it]Generating:  13%|████████████▉                                                                                    | 21/157 [12:18<1:21:16, 35.86s/it]Generating:  14%|█████████████▌                                                                                   | 22/157 [12:57<1:22:32, 36.69s/it]Generating:  15%|██████████████▏                                                                                  | 23/157 [13:32<1:20:41, 36.13s/it]Generating:  15%|██████████████▊                                                                                  | 24/157 [14:06<1:18:55, 35.60s/it]Generating:  16%|███████████████▍                                                                                 | 25/157 [14:41<1:17:56, 35.42s/it]Generating:  17%|████████████████                                                                                 | 26/157 [15:17<1:17:27, 35.47s/it]Generating:  17%|████████████████▋                                                                                | 27/157 [15:53<1:17:03, 35.56s/it]Generating:  18%|█████████████████▎                                                                               | 28/157 [16:28<1:16:39, 35.65s/it]Generating:  18%|█████████████████▉                                                                               | 29/157 [17:05<1:16:41, 35.95s/it]Generating:  19%|██████████████████▌                                                                              | 30/157 [17:40<1:15:11, 35.52s/it]Generating:  20%|███████████████████▏                                                                             | 31/157 [18:15<1:14:16, 35.37s/it]Generating:  20%|███████████████████▊                                                                             | 32/157 [18:49<1:13:06, 35.09s/it]Generating:  21%|████████████████████▍                                                                            | 33/157 [19:24<1:12:42, 35.18s/it]Generating:  22%|█████████████████████                                                                            | 34/157 [20:00<1:12:35, 35.41s/it]Generating:  22%|█████████████████████▌                                                                           | 35/157 [20:35<1:11:45, 35.29s/it]Generating:  23%|██████████████████████▏                                                                          | 36/157 [21:10<1:10:49, 35.12s/it]Generating:  24%|██████████████████████▊                                                                          | 37/157 [21:44<1:09:43, 34.86s/it]Generating:  24%|███████████████████████▍                                                                         | 38/157 [22:20<1:09:37, 35.11s/it]Generating:  25%|████████████████████████                                                                         | 39/157 [22:54<1:08:35, 34.88s/it]Generating:  25%|████████████████████████▋                                                                        | 40/157 [23:29<1:07:46, 34.75s/it]Generating:  26%|█████████████████████████▎                                                                       | 41/157 [24:03<1:06:41, 34.49s/it]Generating:  27%|█████████████████████████▉                                                                       | 42/157 [24:37<1:06:08, 34.51s/it]Generating:  27%|██████████████████████████▌                                                                      | 43/157 [25:12<1:05:48, 34.63s/it]Generating:  28%|███████████████████████████▏                                                                     | 44/157 [25:47<1:05:20, 34.69s/it]Generating:  29%|███████████████████████████▊                                                                     | 45/157 [26:21<1:04:37, 34.62s/it]Generating:  29%|████████████████████████████▍                                                                    | 46/157 [26:56<1:04:03, 34.62s/it]Generating:  30%|█████████████████████████████                                                                    | 47/157 [27:30<1:03:00, 34.37s/it]Generating:  31%|█████████████████████████████▋                                                                   | 48/157 [28:05<1:02:35, 34.45s/it]Generating:  31%|██████████████████████████████▎                                                                  | 49/157 [28:39<1:01:47, 34.33s/it]Generating:  32%|██████████████████████████████▉                                                                  | 50/157 [29:13<1:01:28, 34.47s/it]Generating:  32%|███████████████████████████████▌                                                                 | 51/157 [29:48<1:01:05, 34.58s/it]Generating:  33%|████████████████████████████████▏                                                                | 52/157 [30:22<1:00:20, 34.48s/it]Generating:  34%|█████████████████████████████████▍                                                                 | 53/157 [30:57<59:50, 34.52s/it]Generating:  34%|██████████████████████████████████                                                                 | 54/157 [31:31<59:04, 34.41s/it]Generating:  35%|██████████████████████████████████▋                                                                | 55/157 [32:05<58:22, 34.34s/it]Generating:  36%|███████████████████████████████████▎                                                               | 56/157 [32:40<57:57, 34.43s/it]Generating:  36%|███████████████████████████████████▉                                                               | 57/157 [33:14<57:20, 34.40s/it]Generating:  37%|████████████████████████████████████▌                                                              | 58/157 [33:49<57:03, 34.58s/it]Generating:  38%|█████████████████████████████████████▏                                                             | 59/157 [34:25<56:49, 34.79s/it]Generating:  38%|█████████████████████████████████████▊                                                             | 60/157 [34:59<55:58, 34.63s/it]Generating:  39%|██████████████████████████████████████▍                                                            | 61/157 [35:34<55:24, 34.63s/it]Generating:  39%|███████████████████████████████████████                                                            | 62/157 [36:08<54:57, 34.71s/it]Generating:  40%|███████████████████████████████████████▋                                                           | 63/157 [36:43<54:12, 34.60s/it]Generating:  41%|████████████████████████████████████████▎                                                          | 64/157 [37:17<53:25, 34.47s/it]Generating:  41%|████████████████████████████████████████▉                                                          | 65/157 [37:51<52:29, 34.23s/it]Generating:  42%|█████████████████████████████████████████▌                                                         | 66/157 [38:25<52:06, 34.35s/it]Generating:  43%|██████████████████████████████████████████▏                                                        | 67/157 [39:00<51:44, 34.50s/it]Generating:  43%|██████████████████████████████████████████▉                                                        | 68/157 [39:35<51:31, 34.73s/it]Generating:  44%|███████████████████████████████████████████▌                                                       | 69/157 [40:11<51:11, 34.90s/it]Generating:  45%|████████████████████████████████████████████▏                                                      | 70/157 [40:46<50:33, 34.87s/it]Generating:  45%|████████████████████████████████████████████▊                                                      | 71/157 [41:21<50:02, 34.91s/it]Generating:  46%|█████████████████████████████████████████████▍                                                     | 72/157 [41:55<49:23, 34.86s/it]Generating:  46%|██████████████████████████████████████████████                                                     | 73/157 [42:30<48:37, 34.73s/it]Generating:  47%|██████████████████████████████████████████████▋                                                    | 74/157 [43:04<48:00, 34.70s/it]Generating:  48%|███████████████████████████████████████████████▎                                                   | 75/157 [43:39<47:30, 34.76s/it]Generating:  48%|███████████████████████████████████████████████▉                                                   | 76/157 [44:13<46:32, 34.47s/it]Generating:  49%|████████████████████████████████████████████████▌                                                  | 77/157 [44:47<45:56, 34.46s/it]Generating:  50%|█████████████████████████████████████████████████▏                                                 | 78/157 [45:23<45:51, 34.83s/it]Generating:  50%|█████████████████████████████████████████████████▊                                                 | 79/157 [45:57<44:58, 34.59s/it]Generating:  51%|██████████████████████████████████████████████████▍                                                | 80/157 [46:34<45:12, 35.22s/it]Generating:  52%|███████████████████████████████████████████████████                                                | 81/157 [47:09<44:27, 35.10s/it]Generating:  52%|███████████████████████████████████████████████████▋                                               | 82/157 [47:43<43:39, 34.93s/it]Generating:  53%|████████████████████████████████████████████████████▎                                              | 83/157 [48:19<43:28, 35.25s/it]Generating:  54%|████████████████████████████████████████████████████▉                                              | 84/157 [48:54<42:35, 35.01s/it]Generating:  54%|█████████████████████████████████████████████████████▌                                             | 85/157 [49:28<41:40, 34.72s/it]Generating:  55%|██████████████████████████████████████████████████████▏                                            | 86/157 [50:02<40:59, 34.64s/it]Generating:  55%|██████████████████████████████████████████████████████▊                                            | 87/157 [50:37<40:28, 34.70s/it]Generating:  56%|███████████████████████████████████████████████████████▍                                           | 88/157 [51:12<39:51, 34.65s/it]Generating:  57%|████████████████████████████████████████████████████████                                           | 89/157 [51:48<39:45, 35.08s/it]Generating:  57%|████████████████████████████████████████████████████████▊                                          | 90/157 [52:22<39:00, 34.94s/it]Generating:  58%|█████████████████████████████████████████████████████████▍                                         | 91/157 [52:58<38:36, 35.10s/it]Generating:  59%|██████████████████████████████████████████████████████████                                         | 92/157 [53:31<37:31, 34.64s/it]Generating:  59%|██████████████████████████████████████████████████████████▋                                        | 93/157 [54:06<37:07, 34.81s/it]Generating:  60%|███████████████████████████████████████████████████████████▎                                       | 94/157 [54:41<36:27, 34.73s/it]Generating:  61%|███████████████████████████████████████████████████████████▉                                       | 95/157 [55:17<36:10, 35.01s/it]Generating:  61%|████████████████████████████████████████████████████████████▌                                      | 96/157 [55:52<35:32, 34.96s/it]Generating:  62%|█████████████████████████████████████████████████████████████▏                                     | 97/157 [56:26<34:43, 34.72s/it]Generating:  62%|█████████████████████████████████████████████████████████████▊                                     | 98/157 [57:02<34:32, 35.12s/it]Generating:  63%|██████████████████████████████████████████████████████████████▍                                    | 99/157 [57:38<34:10, 35.35s/it]Generating:  64%|██████████████████████████████████████████████████████████████▍                                   | 100/157 [58:12<33:12, 34.96s/it]Generating:  64%|███████████████████████████████████████████████████████████████                                   | 101/157 [58:48<32:54, 35.26s/it]Generating:  65%|███████████████████████████████████████████████████████████████▋                                  | 102/157 [59:22<32:05, 35.02s/it]Generating:  66%|████████████████████████████████████████████████████████████████▎                                 | 103/157 [59:57<31:23, 34.87s/it]Generating:  66%|███████████████████████████████████████████████████████████████▌                                | 104/157 [1:00:32<30:59, 35.09s/it]Generating:  67%|████████████████████████████████████████████████████████████████▏                               | 105/157 [1:01:07<30:17, 34.95s/it]Generating:  68%|████████████████████████████████████████████████████████████████▊                               | 106/157 [1:01:43<29:59, 35.28s/it]Generating:  68%|█████████████████████████████████████████████████████████████████▍                              | 107/157 [1:02:19<29:32, 35.45s/it]Generating:  69%|██████████████████████████████████████████████████████████████████                              | 108/157 [1:02:54<28:50, 35.32s/it]Generating:  69%|██████████████████████████████████████████████████████████████████▋                             | 109/157 [1:03:28<27:55, 34.91s/it]Generating:  70%|███████████████████████████████████████████████████████████████████▎                            | 110/157 [1:04:03<27:19, 34.89s/it]Generating:  71%|███████████████████████████████████████████████████████████████████▊                            | 111/157 [1:04:37<26:45, 34.90s/it]Generating:  71%|████████████████████████████████████████████████████████████████████▍                           | 112/157 [1:05:12<26:06, 34.82s/it]Generating:  72%|█████████████████████████████████████████████████████████████████████                           | 113/157 [1:05:46<25:18, 34.51s/it]Generating:  73%|█████████████████████████████████████████████████████████████████████▋                          | 114/157 [1:06:20<24:41, 34.46s/it]Generating:  73%|██████████████████████████████████████████████████████████████████████▎                         | 115/157 [1:06:56<24:22, 34.83s/it]Generating:  74%|██████████████████████████████████████████████████████████████████████▉                         | 116/157 [1:07:31<23:46, 34.80s/it]Generating:  75%|███████████████████████████████████████████████████████████████████████▌                        | 117/157 [1:08:05<23:04, 34.61s/it]Generating:  75%|████████████████████████████████████████████████████████████████████████▏                       | 118/157 [1:08:40<22:31, 34.65s/it]Generating:  76%|████████████████████████████████████████████████████████████████████████▊                       | 119/157 [1:09:14<21:54, 34.59s/it]Generating:  76%|█████████████████████████████████████████████████████████████████████████▍                      | 120/157 [1:09:48<21:15, 34.46s/it]Generating:  77%|█████████████████████████████████████████████████████████████████████████▉                      | 121/157 [1:10:24<20:52, 34.80s/it]Generating:  78%|██████████████████████████████████████████████████████████████████████████▌                     | 122/157 [1:10:58<20:12, 34.66s/it]Generating:  78%|███████████████████████████████████████████████████████████████████████████▏                    | 123/157 [1:11:33<19:42, 34.79s/it]Generating:  79%|███████████████████████████████████████████████████████████████████████████▊                    | 124/157 [1:12:08<19:07, 34.76s/it]Generating:  80%|████████████████████████████████████████████████████████████████████████████▍                   | 125/157 [1:12:43<18:40, 35.00s/it]Generating:  80%|█████████████████████████████████████████████████████████████████████████████                   | 126/157 [1:13:19<18:07, 35.09s/it]Generating:  81%|█████████████████████████████████████████████████████████████████████████████▋                  | 127/157 [1:13:54<17:31, 35.06s/it]Generating:  82%|██████████████████████████████████████████████████████████████████████████████▎                 | 128/157 [1:14:30<17:04, 35.33s/it]Generating:  82%|██████████████████████████████████████████████████████████████████████████████▉                 | 129/157 [1:15:05<16:27, 35.26s/it]Generating:  83%|███████████████████████████████████████████████████████████████████████████████▍                | 130/157 [1:15:41<15:58, 35.52s/it]Generating:  83%|████████████████████████████████████████████████████████████████████████████████                | 131/157 [1:16:16<15:23, 35.53s/it]Generating:  84%|████████████████████████████████████████████████████████████████████████████████▋               | 132/157 [1:16:52<14:49, 35.58s/it]Generating:  85%|█████████████████████████████████████████████████████████████████████████████████▎              | 133/157 [1:17:27<14:11, 35.49s/it]Generating:  85%|█████████████████████████████████████████████████████████████████████████████████▉              | 134/157 [1:18:01<13:24, 34.98s/it]Generating:  86%|██████████████████████████████████████████████████████████████████████████████████▌             | 135/157 [1:18:36<12:49, 34.96s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████▏            | 136/157 [1:19:11<12:13, 34.95s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████▊            | 137/157 [1:19:45<11:34, 34.73s/it]Generating:  88%|████████████████████████████████████████████████████████████████████████████████████▍           | 138/157 [1:20:20<11:00, 34.75s/it]Generating:  89%|████████████████████████████████████████████████████████████████████████████████████▉           | 139/157 [1:20:55<10:26, 34.82s/it]Generating:  89%|█████████████████████████████████████████████████████████████████████████████████████▌          | 140/157 [1:21:29<09:46, 34.51s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████▏         | 141/157 [1:22:03<09:12, 34.53s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████▊         | 142/157 [1:22:39<08:41, 34.76s/it]Generating:  91%|███████████████████████████████████████████████████████████████████████████████████████▍        | 143/157 [1:23:13<08:03, 34.52s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████        | 144/157 [1:23:48<07:31, 34.75s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████▋       | 145/157 [1:24:23<06:56, 34.74s/it]Generating:  93%|█████████████████████████████████████████████████████████████████████████████████████████▎      | 146/157 [1:24:57<06:21, 34.67s/it]Generating:  94%|█████████████████████████████████████████████████████████████████████████████████████████▉      | 147/157 [1:25:32<05:46, 34.68s/it]Generating:  94%|██████████████████████████████████████████████████████████████████████████████████████████▍     | 148/157 [1:26:07<05:12, 34.75s/it]Generating:  95%|███████████████████████████████████████████████████████████████████████████████████████████     | 149/157 [1:26:42<04:39, 34.88s/it]Generating:  96%|███████████████████████████████████████████████████████████████████████████████████████████▋    | 150/157 [1:27:17<04:04, 34.98s/it]Generating:  96%|████████████████████████████████████████████████████████████████████████████████████████████▎   | 151/157 [1:27:53<03:30, 35.08s/it]Generating:  97%|████████████████████████████████████████████████████████████████████████████████████████████▉   | 152/157 [1:28:26<02:53, 34.71s/it]Generating:  97%|█████████████████████████████████████████████████████████████████████████████████████████████▌  | 153/157 [1:29:01<02:18, 34.57s/it]Generating:  98%|██████████████████████████████████████████████████████████████████████████████████████████████▏ | 154/157 [1:29:35<01:43, 34.50s/it]Generating:  99%|██████████████████████████████████████████████████████████████████████████████████████████████▊ | 155/157 [1:30:11<01:09, 34.98s/it]Generating:  99%|███████████████████████████████████████████████████████████████████████████████████████████████▍| 156/157 [1:30:47<00:35, 35.18s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [1:31:02<00:00, 29.08s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [1:31:02<00:00, 34.79s/it]
Fetching 5 files:   0%|                                                                                                        | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 6278.90it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
