`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                                          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|████████████████████████▌                                                                         | 1/4 [00:10<00:30, 10.15s/it]Loading checkpoint shards:  50%|█████████████████████████████████████████████████                                                 | 2/4 [00:20<00:20, 10.11s/it]Loading checkpoint shards:  75%|█████████████████████████████████████████████████████████████████████████▌                        | 3/4 [00:29<00:09,  9.68s/it]Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  6.79s/it]Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:31<00:00,  7.94s/it]
Generating:   0%|                                                                                                                       | 0/157 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p', 'top_k']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Generating:   1%|▋                                                                                                              | 1/157 [00:05<13:10,  5.07s/it]Generating:   1%|█▍                                                                                                             | 2/157 [00:09<12:41,  4.91s/it]Generating:   2%|██                                                                                                             | 3/157 [00:14<12:04,  4.71s/it]Generating:   3%|██▊                                                                                                            | 4/157 [00:18<11:42,  4.59s/it]Generating:   3%|███▌                                                                                                           | 5/157 [00:23<11:26,  4.51s/it]Generating:   4%|████▏                                                                                                          | 6/157 [00:27<11:07,  4.42s/it]Generating:   4%|████▉                                                                                                          | 7/157 [00:31<11:08,  4.46s/it]Generating:   5%|█████▋                                                                                                         | 8/157 [00:36<11:16,  4.54s/it]Generating:   6%|██████▎                                                                                                        | 9/157 [00:41<11:20,  4.60s/it]Generating:   6%|███████                                                                                                       | 10/157 [00:46<11:26,  4.67s/it]Generating:   7%|███████▋                                                                                                      | 11/157 [00:49<10:41,  4.40s/it]Generating:   8%|████████▍                                                                                                     | 12/157 [00:54<10:48,  4.47s/it]Generating:   8%|█████████                                                                                                     | 13/157 [00:59<10:55,  4.55s/it]Generating:   9%|█████████▊                                                                                                    | 14/157 [01:03<10:33,  4.43s/it]Generating:  10%|██████████▌                                                                                                   | 15/157 [01:08<10:33,  4.46s/it]Generating:  10%|███████████▏                                                                                                  | 16/157 [01:12<10:18,  4.39s/it]Generating:  11%|███████████▉                                                                                                  | 17/157 [01:17<10:55,  4.68s/it]Generating:  11%|████████████▌                                                                                                 | 18/157 [01:22<11:02,  4.77s/it]Generating:  12%|█████████████▎                                                                                                | 19/157 [01:26<10:28,  4.55s/it]Generating:  13%|██████████████                                                                                                | 20/157 [01:31<10:26,  4.58s/it]Generating:  13%|██████████████▋                                                                                               | 21/157 [01:36<10:38,  4.69s/it]Generating:  14%|███████████████▍                                                                                              | 22/157 [01:41<11:04,  4.92s/it]Generating:  15%|████████████████                                                                                              | 23/157 [01:47<11:18,  5.06s/it]Generating:  15%|████████████████▊                                                                                             | 24/157 [01:51<10:49,  4.89s/it]Generating:  16%|█████████████████▌                                                                                            | 25/157 [01:55<10:25,  4.74s/it]Generating:  17%|██████████████████▏                                                                                           | 26/157 [01:59<09:47,  4.48s/it]Generating:  17%|██████████████████▉                                                                                           | 27/157 [02:03<09:28,  4.37s/it]Generating:  18%|███████████████████▌                                                                                          | 28/157 [02:09<10:02,  4.67s/it]Generating:  18%|████████████████████▎                                                                                         | 29/157 [02:13<09:56,  4.66s/it]Generating:  19%|█████████████████████                                                                                         | 30/157 [02:19<10:08,  4.79s/it]Generating:  20%|█████████████████████▋                                                                                        | 31/157 [02:25<11:04,  5.27s/it]Generating:  20%|██████████████████████▍                                                                                       | 32/157 [02:30<10:46,  5.18s/it]Generating:  21%|███████████████████████                                                                                       | 33/157 [02:35<10:42,  5.19s/it]Generating:  22%|███████████████████████▊                                                                                      | 34/157 [02:40<10:20,  5.04s/it]Generating:  22%|████████████████████████▌                                                                                     | 35/157 [02:44<09:55,  4.88s/it]Generating:  23%|█████████████████████████▏                                                                                    | 36/157 [02:49<09:37,  4.77s/it]Generating:  24%|█████████████████████████▉                                                                                    | 37/157 [02:52<08:38,  4.32s/it]Generating:  24%|██████████████████████████▌                                                                                   | 38/157 [02:57<08:42,  4.39s/it]Generating:  25%|███████████████████████████▎                                                                                  | 39/157 [03:01<08:35,  4.37s/it]Generating:  25%|████████████████████████████                                                                                  | 40/157 [03:06<08:48,  4.52s/it]Generating:  26%|████████████████████████████▋                                                                                 | 41/157 [03:10<08:34,  4.44s/it]Generating:  27%|█████████████████████████████▍                                                                                | 42/157 [03:15<08:31,  4.45s/it]Generating:  27%|██████████████████████████████▏                                                                               | 43/157 [03:19<08:23,  4.41s/it]Generating:  28%|██████████████████████████████▊                                                                               | 44/157 [03:23<07:57,  4.23s/it]Generating:  29%|███████████████████████████████▌                                                                              | 45/157 [03:27<07:46,  4.16s/it]Generating:  29%|████████████████████████████████▏                                                                             | 46/157 [03:32<08:04,  4.37s/it]Generating:  30%|████████████████████████████████▉                                                                             | 47/157 [03:36<08:04,  4.40s/it]Generating:  31%|█████████████████████████████████▋                                                                            | 48/157 [03:41<08:18,  4.58s/it]Generating:  31%|██████████████████████████████████▎                                                                           | 49/157 [03:45<08:08,  4.52s/it]Generating:  32%|███████████████████████████████████                                                                           | 50/157 [03:49<07:38,  4.28s/it]Generating:  32%|███████████████████████████████████▋                                                                          | 51/157 [03:54<07:49,  4.43s/it]Generating:  33%|████████████████████████████████████▍                                                                         | 52/157 [03:58<07:34,  4.33s/it]Generating:  34%|█████████████████████████████████████▏                                                                        | 53/157 [04:03<07:37,  4.40s/it]Generating:  34%|█████████████████████████████████████▊                                                                        | 54/157 [04:08<07:53,  4.60s/it]Generating:  35%|██████████████████████████████████████▌                                                                       | 55/157 [04:13<08:08,  4.79s/it]Generating:  36%|███████████████████████████████████████▏                                                                      | 56/157 [04:17<07:46,  4.61s/it]Generating:  36%|███████████████████████████████████████▉                                                                      | 57/157 [04:21<07:14,  4.34s/it]Generating:  37%|████████████████████████████████████████▋                                                                     | 58/157 [04:26<07:27,  4.52s/it]Generating:  38%|█████████████████████████████████████████▎                                                                    | 59/157 [04:31<07:34,  4.64s/it]Generating:  38%|██████████████████████████████████████████                                                                    | 60/157 [04:35<07:18,  4.53s/it]Generating:  39%|██████████████████████████████████████████▋                                                                   | 61/157 [04:41<08:00,  5.00s/it]Generating:  39%|███████████████████████████████████████████▍                                                                  | 62/157 [04:46<07:47,  4.92s/it]Generating:  40%|████████████████████████████████████████████▏                                                                 | 63/157 [04:51<08:03,  5.14s/it]Generating:  41%|████████████████████████████████████████████▊                                                                 | 64/157 [04:56<07:36,  4.91s/it]Generating:  41%|█████████████████████████████████████████████▌                                                                | 65/157 [04:59<07:00,  4.57s/it]Generating:  42%|██████████████████████████████████████████████▏                                                               | 66/157 [05:04<06:43,  4.43s/it]Generating:  43%|██████████████████████████████████████████████▉                                                               | 67/157 [05:08<06:37,  4.42s/it]Generating:  43%|███████████████████████████████████████████████▋                                                              | 68/157 [05:13<06:41,  4.51s/it]Generating:  44%|████████████████████████████████████████████████▎                                                             | 69/157 [05:17<06:25,  4.38s/it]Generating:  45%|█████████████████████████████████████████████████                                                             | 70/157 [05:21<06:09,  4.25s/it]Generating:  45%|█████████████████████████████████████████████████▋                                                            | 71/157 [05:25<06:02,  4.21s/it]Generating:  46%|██████████████████████████████████████████████████▍                                                           | 72/157 [05:29<06:03,  4.28s/it]Generating:  46%|███████████████████████████████████████████████████▏                                                          | 73/157 [05:34<06:01,  4.30s/it]Generating:  47%|███████████████████████████████████████████████████▊                                                          | 74/157 [05:38<06:08,  4.44s/it]Generating:  48%|████████████████████████████████████████████████████▌                                                         | 75/157 [05:42<05:48,  4.26s/it]Generating:  48%|█████████████████████████████████████████████████████▏                                                        | 76/157 [05:47<06:06,  4.52s/it]Generating:  49%|█████████████████████████████████████████████████████▉                                                        | 77/157 [05:52<06:01,  4.52s/it]Generating:  50%|██████████████████████████████████████████████████████▋                                                       | 78/157 [05:57<06:20,  4.82s/it]Generating:  50%|███████████████████████████████████████████████████████▎                                                      | 79/157 [06:02<06:04,  4.68s/it]Generating:  51%|████████████████████████████████████████████████████████                                                      | 80/157 [06:08<06:40,  5.20s/it]Generating:  52%|████████████████████████████████████████████████████████▊                                                     | 81/157 [06:12<06:03,  4.79s/it]Generating:  52%|█████████████████████████████████████████████████████████▍                                                    | 82/157 [06:18<06:20,  5.08s/it]Generating:  53%|██████████████████████████████████████████████████████████▏                                                   | 83/157 [06:23<06:28,  5.25s/it]Generating:  54%|██████████████████████████████████████████████████████████▊                                                   | 84/157 [06:29<06:19,  5.20s/it]Generating:  54%|███████████████████████████████████████████████████████████▌                                                  | 85/157 [06:33<05:54,  4.93s/it]Generating:  55%|████████████████████████████████████████████████████████████▎                                                 | 86/157 [06:37<05:44,  4.85s/it]Generating:  55%|████████████████████████████████████████████████████████████▉                                                 | 87/157 [06:43<05:48,  4.98s/it]Generating:  56%|█████████████████████████████████████████████████████████████▋                                                | 88/157 [06:47<05:31,  4.81s/it]Generating:  57%|██████████████████████████████████████████████████████████████▎                                               | 89/157 [06:53<05:44,  5.06s/it]Generating:  57%|███████████████████████████████████████████████████████████████                                               | 90/157 [06:57<05:19,  4.77s/it]Generating:  58%|███████████████████████████████████████████████████████████████▊                                              | 91/157 [07:02<05:13,  4.75s/it]Generating:  59%|████████████████████████████████████████████████████████████████▍                                             | 92/157 [07:06<04:52,  4.50s/it]Generating:  59%|█████████████████████████████████████████████████████████████████▏                                            | 93/157 [07:10<04:50,  4.54s/it]Generating:  60%|█████████████████████████████████████████████████████████████████▊                                            | 94/157 [07:15<04:59,  4.75s/it]Generating:  61%|██████████████████████████████████████████████████████████████████▌                                           | 95/157 [07:21<05:10,  5.01s/it]Generating:  61%|███████████████████████████████████████████████████████████████████▎                                          | 96/157 [07:26<05:08,  5.05s/it]Generating:  62%|███████████████████████████████████████████████████████████████████▉                                          | 97/157 [07:31<05:03,  5.06s/it]Generating:  62%|████████████████████████████████████████████████████████████████████▋                                         | 98/157 [07:37<05:09,  5.24s/it]Generating:  63%|█████████████████████████████████████████████████████████████████████▎                                        | 99/157 [07:42<04:59,  5.16s/it]Generating:  64%|█████████████████████████████████████████████████████████████████████▍                                       | 100/157 [07:48<05:05,  5.37s/it]Generating:  64%|██████████████████████████████████████████████████████████████████████                                       | 101/157 [07:53<05:00,  5.36s/it]Generating:  65%|██████████████████████████████████████████████████████████████████████▊                                      | 102/157 [07:57<04:27,  4.87s/it]Generating:  66%|███████████████████████████████████████████████████████████████████████▌                                     | 103/157 [08:02<04:33,  5.06s/it]Generating:  66%|████████████████████████████████████████████████████████████████████████▏                                    | 104/157 [08:05<03:55,  4.44s/it]Generating:  67%|████████████████████████████████████████████████████████████████████████▉                                    | 105/157 [08:10<03:57,  4.57s/it]Generating:  68%|█████████████████████████████████████████████████████████████████████████▌                                   | 106/157 [08:14<03:41,  4.34s/it]Generating:  68%|██████████████████████████████████████████████████████████████████████████▎                                  | 107/157 [08:19<03:41,  4.42s/it]Generating:  69%|██████████████████████████████████████████████████████████████████████████▉                                  | 108/157 [08:23<03:32,  4.33s/it]Generating:  69%|███████████████████████████████████████████████████████████████████████████▋                                 | 109/157 [08:27<03:25,  4.28s/it]Generating:  70%|████████████████████████████████████████████████████████████████████████████▎                                | 110/157 [08:31<03:21,  4.30s/it]Generating:  71%|█████████████████████████████████████████████████████████████████████████████                                | 111/157 [08:36<03:18,  4.31s/it]Generating:  71%|█████████████████████████████████████████████████████████████████████████████▊                               | 112/157 [08:42<03:41,  4.92s/it]Generating:  72%|██████████████████████████████████████████████████████████████████████████████▍                              | 113/157 [08:46<03:25,  4.66s/it]Generating:  73%|███████████████████████████████████████████████████████████████████████████████▏                             | 114/157 [08:49<03:03,  4.28s/it]Generating:  73%|███████████████████████████████████████████████████████████████████████████████▊                             | 115/157 [08:54<03:07,  4.47s/it]Generating:  74%|████████████████████████████████████████████████████████████████████████████████▌                            | 116/157 [08:59<03:09,  4.62s/it]Generating:  75%|█████████████████████████████████████████████████████████████████████████████████▏                           | 117/157 [09:04<03:09,  4.74s/it]Generating:  75%|█████████████████████████████████████████████████████████████████████████████████▉                           | 118/157 [09:09<03:06,  4.77s/it]Generating:  76%|██████████████████████████████████████████████████████████████████████████████████▌                          | 119/157 [09:14<03:00,  4.75s/it]Generating:  76%|███████████████████████████████████████████████████████████████████████████████████▎                         | 120/157 [09:18<02:51,  4.64s/it]Generating:  77%|████████████████████████████████████████████████████████████████████████████████████                         | 121/157 [09:23<02:46,  4.61s/it]Generating:  78%|████████████████████████████████████████████████████████████████████████████████████▋                        | 122/157 [09:27<02:39,  4.56s/it]Generating:  78%|█████████████████████████████████████████████████████████████████████████████████████▍                       | 123/157 [09:31<02:31,  4.45s/it]Generating:  79%|██████████████████████████████████████████████████████████████████████████████████████                       | 124/157 [09:35<02:23,  4.36s/it]Generating:  80%|██████████████████████████████████████████████████████████████████████████████████████▊                      | 125/157 [09:40<02:17,  4.28s/it]Generating:  80%|███████████████████████████████████████████████████████████████████████████████████████▍                     | 126/157 [09:44<02:16,  4.40s/it]Generating:  81%|████████████████████████████████████████████████████████████████████████████████████████▏                    | 127/157 [09:49<02:13,  4.44s/it]Generating:  82%|████████████████████████████████████████████████████████████████████████████████████████▊                    | 128/157 [09:54<02:11,  4.55s/it]Generating:  82%|█████████████████████████████████████████████████████████████████████████████████████████▌                   | 129/157 [09:59<02:11,  4.70s/it]Generating:  83%|██████████████████████████████████████████████████████████████████████████████████████████▎                  | 130/157 [10:04<02:10,  4.82s/it]Generating:  83%|██████████████████████████████████████████████████████████████████████████████████████████▉                  | 131/157 [10:10<02:12,  5.10s/it]Generating:  84%|███████████████████████████████████████████████████████████████████████████████████████████▋                 | 132/157 [10:14<01:59,  4.77s/it]Generating:  85%|████████████████████████████████████████████████████████████████████████████████████████████▎                | 133/157 [10:18<01:50,  4.59s/it]Generating:  85%|█████████████████████████████████████████████████████████████████████████████████████████████                | 134/157 [10:23<01:48,  4.73s/it]Generating:  86%|█████████████████████████████████████████████████████████████████████████████████████████████▋               | 135/157 [10:29<01:53,  5.16s/it]Generating:  87%|██████████████████████████████████████████████████████████████████████████████████████████████▍              | 136/157 [10:32<01:32,  4.40s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████████████████              | 137/157 [10:35<01:24,  4.21s/it]Generating:  88%|███████████████████████████████████████████████████████████████████████████████████████████████▊             | 138/157 [10:40<01:20,  4.24s/it]Generating:  89%|████████████████████████████████████████████████████████████████████████████████████████████████▌            | 139/157 [10:44<01:18,  4.37s/it]Generating:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████▏           | 140/157 [10:48<01:10,  4.15s/it]Generating:  90%|█████████████████████████████████████████████████████████████████████████████████████████████████▉           | 141/157 [10:53<01:09,  4.33s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████████████████▌          | 142/157 [10:57<01:04,  4.32s/it]Generating:  91%|███████████████████████████████████████████████████████████████████████████████████████████████████▎         | 143/157 [11:01<00:58,  4.15s/it]Generating:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████▉         | 144/157 [11:05<00:55,  4.24s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 145/157 [11:10<00:51,  4.27s/it]Generating:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 146/157 [11:14<00:46,  4.27s/it]Generating:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████       | 147/157 [11:18<00:41,  4.18s/it]Generating:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 148/157 [11:23<00:39,  4.42s/it]Generating:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████▍     | 149/157 [11:28<00:36,  4.55s/it]Generating:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████▏    | 150/157 [11:31<00:30,  4.35s/it]Generating:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 151/157 [11:37<00:27,  4.59s/it]Generating:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 152/157 [11:40<00:21,  4.26s/it]Generating:  97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 153/157 [11:44<00:16,  4.14s/it]Generating:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 154/157 [11:48<00:12,  4.19s/it]Generating:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 155/157 [11:52<00:08,  4.16s/it]Generating:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 156/157 [11:58<00:04,  4.57s/it]Generating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [12:00<00:00,  3.71s/it]Generating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [12:00<00:00,  4.59s/it]
Fetching 5 files:   0%|                                                                                                                   | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 1020.41it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 4_wmt_evaluation.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A40') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
