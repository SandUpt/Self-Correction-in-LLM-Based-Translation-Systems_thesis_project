`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                               | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|█████████████████████▊                                                                 | 1/4 [00:00<00:02,  1.29it/s]Loading checkpoint shards:  50%|███████████████████████████████████████████▌                                           | 2/4 [00:01<00:01,  1.37it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████████████████████████▎                     | 3/4 [00:02<00:00,  1.42it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  2.02it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.72it/s]
Generating:   0%|                                                                                                             | 0/63 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Generating:   2%|█▌                                                                                                   | 1/63 [00:19<20:08, 19.50s/it]Generating:   3%|███▏                                                                                                 | 2/63 [00:39<20:22, 20.04s/it]Generating:   5%|████▊                                                                                                | 3/63 [00:59<19:36, 19.60s/it]Generating:   6%|██████▍                                                                                              | 4/63 [01:18<19:14, 19.56s/it]Generating:   8%|████████                                                                                             | 5/63 [01:37<18:48, 19.46s/it]Generating:  10%|█████████▌                                                                                           | 6/63 [01:57<18:38, 19.62s/it]Generating:  11%|███████████▏                                                                                         | 7/63 [02:17<18:24, 19.73s/it]Generating:  13%|████████████▊                                                                                        | 8/63 [02:24<14:16, 15.57s/it]Generating:  14%|██████████████▍                                                                                      | 9/63 [02:43<15:05, 16.77s/it]Generating:  16%|███████████████▊                                                                                    | 10/63 [03:03<15:41, 17.76s/it]Generating:  17%|█████████████████▍                                                                                  | 11/63 [03:23<15:59, 18.46s/it]Generating:  19%|███████████████████                                                                                 | 12/63 [03:43<15:59, 18.81s/it]Generating:  21%|████████████████████▋                                                                               | 13/63 [04:03<15:58, 19.17s/it]Generating:  22%|██████████████████████▏                                                                             | 14/63 [04:23<15:49, 19.39s/it]Generating:  24%|███████████████████████▊                                                                            | 15/63 [04:42<15:29, 19.36s/it]Generating:  25%|█████████████████████████▍                                                                          | 16/63 [05:02<15:23, 19.66s/it]Generating:  27%|██████████████████████████▉                                                                         | 17/63 [05:22<14:59, 19.55s/it]Generating:  29%|████████████████████████████▌                                                                       | 18/63 [05:42<14:49, 19.76s/it]Generating:  30%|██████████████████████████████▏                                                                     | 19/63 [06:01<14:21, 19.59s/it]Generating:  32%|███████████████████████████████▋                                                                    | 20/63 [06:21<14:09, 19.76s/it]Generating:  33%|█████████████████████████████████▎                                                                  | 21/63 [06:41<13:50, 19.78s/it]Generating:  35%|██████████████████████████████████▉                                                                 | 22/63 [07:01<13:34, 19.86s/it]Generating:  37%|████████████████████████████████████▌                                                               | 23/63 [07:21<13:13, 19.85s/it]Generating:  38%|██████████████████████████████████████                                                              | 24/63 [07:40<12:49, 19.74s/it]Generating:  40%|███████████████████████████████████████▋                                                            | 25/63 [08:00<12:30, 19.76s/it]Generating:  41%|█████████████████████████████████████████▎                                                          | 26/63 [08:20<12:08, 19.68s/it]Generating:  43%|██████████████████████████████████████████▊                                                         | 27/63 [08:40<11:51, 19.75s/it]Generating:  44%|████████████████████████████████████████████▍                                                       | 28/63 [08:59<11:26, 19.63s/it]Generating:  46%|██████████████████████████████████████████████                                                      | 29/63 [09:19<11:13, 19.82s/it]Generating:  48%|███████████████████████████████████████████████▌                                                    | 30/63 [09:39<10:50, 19.70s/it]Generating:  49%|█████████████████████████████████████████████████▏                                                  | 31/63 [09:58<10:29, 19.68s/it]Generating:  51%|██████████████████████████████████████████████████▊                                                 | 32/63 [10:18<10:09, 19.66s/it]Generating:  52%|████████████████████████████████████████████████████▍                                               | 33/63 [10:37<09:44, 19.48s/it]Generating:  54%|█████████████████████████████████████████████████████▉                                              | 34/63 [10:45<07:44, 16.00s/it]Generating:  56%|███████████████████████████████████████████████████████▌                                            | 35/63 [11:05<07:58, 17.10s/it]Generating:  57%|█████████████████████████████████████████████████████████▏                                          | 36/63 [11:25<08:07, 18.06s/it]Generating:  59%|██████████████████████████████████████████████████████████▋                                         | 37/63 [11:44<07:59, 18.45s/it]Generating:  60%|████████████████████████████████████████████████████████████▎                                       | 38/63 [12:03<07:46, 18.67s/it]Generating:  62%|█████████████████████████████████████████████████████████████▉                                      | 39/63 [12:23<07:37, 19.05s/it]Generating:  63%|███████████████████████████████████████████████████████████████▍                                    | 40/63 [12:43<07:25, 19.35s/it]Generating:  65%|█████████████████████████████████████████████████████████████████                                   | 41/63 [13:03<07:08, 19.46s/it]Generating:  67%|██████████████████████████████████████████████████████████████████▋                                 | 42/63 [13:22<06:45, 19.32s/it]Generating:  68%|████████████████████████████████████████████████████████████████████▎                               | 43/63 [13:42<06:30, 19.52s/it]Generating:  70%|█████████████████████████████████████████████████████████████████████▊                              | 44/63 [14:02<06:12, 19.60s/it]Generating:  71%|███████████████████████████████████████████████████████████████████████▍                            | 45/63 [14:21<05:52, 19.59s/it]Generating:  73%|█████████████████████████████████████████████████████████████████████████                           | 46/63 [14:41<05:32, 19.53s/it]Generating:  75%|██████████████████████████████████████████████████████████████████████████▌                         | 47/63 [15:01<05:15, 19.72s/it]Generating:  76%|████████████████████████████████████████████████████████████████████████████▏                       | 48/63 [15:21<04:56, 19.78s/it]Generating:  78%|█████████████████████████████████████████████████████████████████████████████▊                      | 49/63 [15:41<04:37, 19.85s/it]Generating:  79%|███████████████████████████████████████████████████████████████████████████████▎                    | 50/63 [16:00<04:15, 19.68s/it]Generating:  81%|████████████████████████████████████████████████████████████████████████████████▉                   | 51/63 [16:19<03:54, 19.54s/it]Generating:  83%|██████████████████████████████████████████████████████████████████████████████████▌                 | 52/63 [16:39<03:34, 19.49s/it]Generating:  84%|████████████████████████████████████████████████████████████████████████████████████▏               | 53/63 [16:58<03:14, 19.42s/it]Generating:  86%|█████████████████████████████████████████████████████████████████████████████████████▋              | 54/63 [17:18<02:55, 19.47s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████████▎            | 55/63 [17:38<02:38, 19.79s/it]Generating:  89%|████████████████████████████████████████████████████████████████████████████████████████▉           | 56/63 [17:58<02:18, 19.76s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████████▍         | 57/63 [18:18<01:59, 19.86s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████████        | 58/63 [18:37<01:38, 19.74s/it]Generating:  94%|█████████████████████████████████████████████████████████████████████████████████████████████▋      | 59/63 [18:57<01:18, 19.62s/it]Generating:  95%|███████████████████████████████████████████████████████████████████████████████████████████████▏    | 60/63 [19:16<00:58, 19.59s/it]Generating:  97%|████████████████████████████████████████████████████████████████████████████████████████████████▊   | 61/63 [19:37<00:39, 19.84s/it]Generating:  98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍ | 62/63 [19:56<00:19, 19.82s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [20:11<00:00, 18.16s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [20:11<00:00, 19.23s/it]
Fetching 5 files:   0%|                                                                                                        | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 3951.67it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
