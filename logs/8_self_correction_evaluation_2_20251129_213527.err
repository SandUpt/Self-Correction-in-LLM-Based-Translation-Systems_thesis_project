`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                               | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|█████████████████████▊                                                                 | 1/4 [00:03<00:11,  3.87s/it]Loading checkpoint shards:  50%|███████████████████████████████████████████▌                                           | 2/4 [00:10<00:11,  5.56s/it]Loading checkpoint shards:  75%|█████████████████████████████████████████████████████████████████▎                     | 3/4 [00:11<00:03,  3.42s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:11<00:00,  2.14s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:11<00:00,  2.92s/it]
Generating:   0%|                                                                                                            | 0/157 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Generating:   1%|▌                                                                                                 | 1/157 [00:52<2:16:47, 52.61s/it]Generating:   1%|█▏                                                                                                | 2/157 [01:45<2:15:37, 52.50s/it]Generating:   2%|█▊                                                                                                | 3/157 [02:37<2:15:14, 52.69s/it]Generating:   3%|██▍                                                                                               | 4/157 [03:30<2:14:40, 52.81s/it]Generating:   3%|███                                                                                               | 5/157 [04:25<2:15:03, 53.31s/it]Generating:   4%|███▋                                                                                              | 6/157 [05:17<2:13:29, 53.05s/it]Generating:   4%|████▎                                                                                             | 7/157 [06:11<2:13:32, 53.41s/it]Generating:   5%|████▉                                                                                             | 8/157 [07:05<2:13:00, 53.56s/it]Generating:   6%|█████▌                                                                                            | 9/157 [07:59<2:12:12, 53.60s/it]Generating:   6%|██████▏                                                                                          | 10/157 [08:54<2:12:11, 53.95s/it]Generating:   7%|██████▊                                                                                          | 11/157 [09:45<2:09:30, 53.22s/it]Generating:   8%|███████▍                                                                                         | 12/157 [10:39<2:09:10, 53.45s/it]Generating:   8%|████████                                                                                         | 13/157 [11:34<2:09:20, 53.89s/it]Generating:   9%|████████▋                                                                                        | 14/157 [12:27<2:07:50, 53.64s/it]Generating:  10%|█████████▎                                                                                       | 15/157 [13:20<2:06:19, 53.38s/it]Generating:  10%|█████████▉                                                                                       | 16/157 [14:13<2:05:13, 53.29s/it]Generating:  11%|██████████▌                                                                                      | 17/157 [15:07<2:04:36, 53.41s/it]Generating:  11%|███████████                                                                                      | 18/157 [16:00<2:03:41, 53.39s/it]Generating:  12%|███████████▋                                                                                     | 19/157 [16:55<2:03:44, 53.80s/it]Generating:  13%|████████████▎                                                                                    | 20/157 [17:48<2:02:14, 53.54s/it]Generating:  13%|████████████▉                                                                                    | 21/157 [18:41<2:01:15, 53.50s/it]Generating:  14%|█████████████▌                                                                                   | 22/157 [19:35<2:00:24, 53.51s/it]Generating:  15%|██████████████▏                                                                                  | 23/157 [20:29<2:00:08, 53.79s/it]Generating:  15%|██████████████▊                                                                                  | 24/157 [21:22<1:58:52, 53.63s/it]Generating:  16%|███████████████▍                                                                                 | 25/157 [22:17<1:58:42, 53.96s/it]Generating:  17%|████████████████                                                                                 | 26/157 [23:10<1:57:12, 53.69s/it]Generating:  17%|████████████████▋                                                                                | 27/157 [24:03<1:55:32, 53.32s/it]Generating:  18%|█████████████████▎                                                                               | 28/157 [24:55<1:53:59, 53.02s/it]Generating:  18%|█████████████████▉                                                                               | 29/157 [25:48<1:52:51, 52.90s/it]Generating:  19%|██████████████████▌                                                                              | 30/157 [26:41<1:52:27, 53.13s/it]Generating:  20%|███████████████████▏                                                                             | 31/157 [27:33<1:50:41, 52.71s/it]Generating:  20%|███████████████████▊                                                                             | 32/157 [28:26<1:50:13, 52.91s/it]Generating:  21%|████████████████████▍                                                                            | 33/157 [29:20<1:49:37, 53.05s/it]Generating:  22%|█████████████████████                                                                            | 34/157 [30:13<1:49:02, 53.19s/it]Generating:  22%|█████████████████████▌                                                                           | 35/157 [31:08<1:49:01, 53.62s/it]Generating:  23%|██████████████████████▏                                                                          | 36/157 [32:02<1:48:20, 53.72s/it]Generating:  24%|██████████████████████▊                                                                          | 37/157 [32:55<1:47:08, 53.57s/it]Generating:  24%|███████████████████████▍                                                                         | 38/157 [33:47<1:45:24, 53.15s/it]Generating:  25%|████████████████████████                                                                         | 39/157 [34:39<1:43:30, 52.63s/it]Generating:  25%|████████████████████████▋                                                                        | 40/157 [35:32<1:42:52, 52.76s/it]Generating:  26%|█████████████████████████▎                                                                       | 41/157 [36:26<1:42:42, 53.12s/it]Generating:  27%|█████████████████████████▉                                                                       | 42/157 [37:18<1:41:15, 52.83s/it]Generating:  27%|██████████████████████████▌                                                                      | 43/157 [38:11<1:40:36, 52.95s/it]Generating:  28%|███████████████████████████▏                                                                     | 44/157 [39:04<1:39:42, 52.94s/it]Generating:  29%|███████████████████████████▊                                                                     | 45/157 [39:57<1:38:54, 52.99s/it]Generating:  29%|████████████████████████████▍                                                                    | 46/157 [40:51<1:38:44, 53.37s/it]Generating:  30%|█████████████████████████████                                                                    | 47/157 [41:44<1:37:21, 53.10s/it]Generating:  31%|█████████████████████████████▋                                                                   | 48/157 [42:39<1:37:26, 53.63s/it]Generating:  31%|██████████████████████████████▎                                                                  | 49/157 [43:33<1:36:53, 53.83s/it]Generating:  32%|██████████████████████████████▉                                                                  | 50/157 [44:28<1:36:23, 54.05s/it]Generating:  32%|███████████████████████████████▌                                                                 | 51/157 [45:21<1:35:17, 53.94s/it]Generating:  33%|████████████████████████████████▏                                                                | 52/157 [46:13<1:33:13, 53.27s/it]Generating:  34%|████████████████████████████████▋                                                                | 53/157 [47:05<1:31:45, 52.94s/it]Generating:  34%|█████████████████████████████████▎                                                               | 54/157 [47:59<1:31:19, 53.20s/it]Generating:  35%|█████████████████████████████████▉                                                               | 55/157 [48:51<1:29:45, 52.80s/it]Generating:  36%|██████████████████████████████████▌                                                              | 56/157 [49:45<1:29:38, 53.26s/it]Generating:  36%|███████████████████████████████████▏                                                             | 57/157 [50:38<1:28:39, 53.19s/it]Generating:  37%|███████████████████████████████████▊                                                             | 58/157 [51:32<1:28:04, 53.38s/it]Generating:  38%|████████████████████████████████████▍                                                            | 59/157 [52:26<1:27:29, 53.56s/it]Generating:  38%|█████████████████████████████████████                                                            | 60/157 [53:18<1:25:47, 53.07s/it]Generating:  39%|█████████████████████████████████████▋                                                           | 61/157 [54:12<1:25:12, 53.26s/it]Generating:  39%|██████████████████████████████████████▎                                                          | 62/157 [55:05<1:24:18, 53.25s/it]Generating:  40%|██████████████████████████████████████▉                                                          | 63/157 [55:58<1:23:25, 53.25s/it]Generating:  41%|███████████████████████████████████████▌                                                         | 64/157 [56:52<1:22:39, 53.33s/it]Generating:  41%|████████████████████████████████████████▏                                                        | 65/157 [57:47<1:22:50, 54.02s/it]Generating:  42%|████████████████████████████████████████▊                                                        | 66/157 [58:40<1:21:18, 53.61s/it]Generating:  43%|█████████████████████████████████████████▍                                                       | 67/157 [59:34<1:20:28, 53.65s/it]Generating:  43%|█████████████████████████████████████████▏                                                     | 68/157 [1:00:28<1:19:55, 53.88s/it]Generating:  44%|█████████████████████████████████████████▊                                                     | 69/157 [1:01:21<1:18:36, 53.59s/it]Generating:  45%|██████████████████████████████████████████▎                                                    | 70/157 [1:02:14<1:17:33, 53.48s/it]Generating:  45%|██████████████████████████████████████████▉                                                    | 71/157 [1:03:09<1:17:12, 53.86s/it]Generating:  46%|███████████████████████████████████████████▌                                                   | 72/157 [1:04:03<1:16:20, 53.89s/it]Generating:  46%|████████████████████████████████████████████▏                                                  | 73/157 [1:04:56<1:15:18, 53.79s/it]Generating:  47%|████████████████████████████████████████████▊                                                  | 74/157 [1:05:50<1:14:21, 53.76s/it]Generating:  48%|█████████████████████████████████████████████▍                                                 | 75/157 [1:06:45<1:13:55, 54.09s/it]Generating:  48%|█████████████████████████████████████████████▉                                                 | 76/157 [1:07:39<1:12:51, 53.96s/it]Generating:  49%|██████████████████████████████████████████████▌                                                | 77/157 [1:08:32<1:11:36, 53.70s/it]Generating:  50%|███████████████████████████████████████████████▏                                               | 78/157 [1:09:25<1:10:25, 53.48s/it]Generating:  50%|███████████████████████████████████████████████▊                                               | 79/157 [1:10:18<1:09:18, 53.32s/it]Generating:  51%|████████████████████████████████████████████████▍                                              | 80/157 [1:11:11<1:08:19, 53.24s/it]Generating:  52%|█████████████████████████████████████████████████                                              | 81/157 [1:12:03<1:07:15, 53.10s/it]Generating:  52%|█████████████████████████████████████████████████▌                                             | 82/157 [1:12:58<1:06:59, 53.59s/it]Generating:  53%|██████████████████████████████████████████████████▏                                            | 83/157 [1:13:53<1:06:33, 53.97s/it]Generating:  54%|██████████████████████████████████████████████████▊                                            | 84/157 [1:14:49<1:06:16, 54.47s/it]Generating:  54%|███████████████████████████████████████████████████▍                                           | 85/157 [1:15:43<1:05:27, 54.55s/it]Generating:  55%|████████████████████████████████████████████████████                                           | 86/157 [1:16:36<1:03:58, 54.06s/it]Generating:  55%|████████████████████████████████████████████████████▋                                          | 87/157 [1:17:30<1:03:02, 54.03s/it]Generating:  56%|█████████████████████████████████████████████████████▏                                         | 88/157 [1:18:22<1:01:23, 53.38s/it]Generating:  57%|█████████████████████████████████████████████████████▊                                         | 89/157 [1:19:14<1:00:05, 53.03s/it]Generating:  57%|███████████████████████████████████████████████████████▌                                         | 90/157 [1:20:08<59:29, 53.27s/it]Generating:  58%|████████████████████████████████████████████████████████▏                                        | 91/157 [1:21:03<59:10, 53.80s/it]Generating:  59%|████████████████████████████████████████████████████████▊                                        | 92/157 [1:21:57<58:14, 53.76s/it]Generating:  59%|█████████████████████████████████████████████████████████▍                                       | 93/157 [1:22:48<56:32, 53.00s/it]Generating:  60%|██████████████████████████████████████████████████████████                                       | 94/157 [1:23:42<56:02, 53.38s/it]Generating:  61%|██████████████████████████████████████████████████████████▋                                      | 95/157 [1:24:35<55:03, 53.28s/it]Generating:  61%|███████████████████████████████████████████████████████████▎                                     | 96/157 [1:25:29<54:11, 53.30s/it]Generating:  62%|███████████████████████████████████████████████████████████▉                                     | 97/157 [1:26:22<53:11, 53.19s/it]Generating:  62%|████████████████████████████████████████████████████████████▌                                    | 98/157 [1:27:16<52:32, 53.43s/it]Generating:  63%|█████████████████████████████████████████████████████████████▏                                   | 99/157 [1:28:07<51:08, 52.91s/it]Generating:  64%|█████████████████████████████████████████████████████████████▏                                  | 100/157 [1:29:01<50:36, 53.28s/it]Generating:  64%|█████████████████████████████████████████████████████████████▊                                  | 101/157 [1:29:53<49:22, 52.90s/it]Generating:  65%|██████████████████████████████████████████████████████████████▎                                 | 102/157 [1:30:45<48:02, 52.40s/it]Generating:  66%|██████████████████████████████████████████████████████████████▉                                 | 103/157 [1:31:39<47:35, 52.87s/it]Generating:  66%|███████████████████████████████████████████████████████████████▌                                | 104/157 [1:32:33<46:59, 53.20s/it]Generating:  67%|████████████████████████████████████████████████████████████████▏                               | 105/157 [1:33:26<46:13, 53.34s/it]Generating:  68%|████████████████████████████████████████████████████████████████▊                               | 106/157 [1:34:20<45:18, 53.30s/it]Generating:  68%|█████████████████████████████████████████████████████████████████▍                              | 107/157 [1:35:13<44:30, 53.42s/it]Generating:  69%|██████████████████████████████████████████████████████████████████                              | 108/157 [1:36:07<43:39, 53.45s/it]Generating:  69%|██████████████████████████████████████████████████████████████████▋                             | 109/157 [1:36:59<42:27, 53.07s/it]Generating:  70%|███████████████████████████████████████████████████████████████████▎                            | 110/157 [1:37:52<41:30, 53.00s/it]Generating:  71%|███████████████████████████████████████████████████████████████████▊                            | 111/157 [1:38:46<40:49, 53.24s/it]Generating:  71%|████████████████████████████████████████████████████████████████████▍                           | 112/157 [1:39:39<39:59, 53.33s/it]Generating:  72%|█████████████████████████████████████████████████████████████████████                           | 113/157 [1:40:31<38:46, 52.88s/it]Generating:  73%|█████████████████████████████████████████████████████████████████████▋                          | 114/157 [1:41:24<37:58, 52.98s/it]Generating:  73%|██████████████████████████████████████████████████████████████████████▎                         | 115/157 [1:42:18<37:19, 53.32s/it]Generating:  74%|██████████████████████████████████████████████████████████████████████▉                         | 116/157 [1:43:11<36:17, 53.11s/it]Generating:  75%|███████████████████████████████████████████████████████████████████████▌                        | 117/157 [1:44:04<35:29, 53.24s/it]Generating:  75%|████████████████████████████████████████████████████████████████████████▏                       | 118/157 [1:44:58<34:43, 53.42s/it]Generating:  76%|████████████████████████████████████████████████████████████████████████▊                       | 119/157 [1:45:52<33:58, 53.63s/it]Generating:  76%|█████████████████████████████████████████████████████████████████████████▍                      | 120/157 [1:46:46<33:01, 53.56s/it]Generating:  77%|█████████████████████████████████████████████████████████████████████████▉                      | 121/157 [1:47:40<32:09, 53.61s/it]Generating:  78%|██████████████████████████████████████████████████████████████████████████▌                     | 122/157 [1:48:33<31:18, 53.67s/it]Generating:  78%|███████████████████████████████████████████████████████████████████████████▏                    | 123/157 [1:49:25<30:03, 53.04s/it]Generating:  79%|███████████████████████████████████████████████████████████████████████████▊                    | 124/157 [1:50:16<28:55, 52.60s/it]Generating:  80%|████████████████████████████████████████████████████████████████████████████▍                   | 125/157 [1:51:10<28:10, 52.83s/it]Generating:  80%|█████████████████████████████████████████████████████████████████████████████                   | 126/157 [1:52:03<27:24, 53.04s/it]Generating:  81%|█████████████████████████████████████████████████████████████████████████████▋                  | 127/157 [1:52:58<26:47, 53.59s/it]Generating:  82%|██████████████████████████████████████████████████████████████████████████████▎                 | 128/157 [1:53:51<25:46, 53.34s/it]Generating:  82%|██████████████████████████████████████████████████████████████████████████████▉                 | 129/157 [1:54:42<24:37, 52.76s/it]Generating:  83%|███████████████████████████████████████████████████████████████████████████████▍                | 130/157 [1:55:34<23:37, 52.49s/it]Generating:  83%|████████████████████████████████████████████████████████████████████████████████                | 131/157 [1:56:28<22:57, 52.98s/it]Generating:  84%|████████████████████████████████████████████████████████████████████████████████▋               | 132/157 [1:57:21<21:58, 52.74s/it]Generating:  85%|█████████████████████████████████████████████████████████████████████████████████▎              | 133/157 [1:58:12<20:59, 52.47s/it]Generating:  85%|█████████████████████████████████████████████████████████████████████████████████▉              | 134/157 [1:59:08<20:26, 53.33s/it]Generating:  86%|██████████████████████████████████████████████████████████████████████████████████▌             | 135/157 [2:00:01<19:33, 53.34s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████▏            | 136/157 [2:00:56<18:49, 53.76s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████▊            | 137/157 [2:01:50<17:57, 53.88s/it]Generating:  88%|████████████████████████████████████████████████████████████████████████████████████▍           | 138/157 [2:02:44<17:01, 53.77s/it]Generating:  89%|████████████████████████████████████████████████████████████████████████████████████▉           | 139/157 [2:03:35<15:57, 53.20s/it]Generating:  89%|█████████████████████████████████████████████████████████████████████████████████████▌          | 140/157 [2:04:30<15:09, 53.47s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████▏         | 141/157 [2:05:24<14:20, 53.81s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████▊         | 142/157 [2:06:18<13:26, 53.77s/it]Generating:  91%|███████████████████████████████████████████████████████████████████████████████████████▍        | 143/157 [2:07:11<12:31, 53.70s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████        | 144/157 [2:08:05<11:38, 53.74s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████▋       | 145/157 [2:08:58<10:41, 53.49s/it]Generating:  93%|█████████████████████████████████████████████████████████████████████████████████████████▎      | 146/157 [2:09:52<09:51, 53.73s/it]Generating:  94%|█████████████████████████████████████████████████████████████████████████████████████████▉      | 147/157 [2:10:45<08:54, 53.44s/it]Generating:  94%|██████████████████████████████████████████████████████████████████████████████████████████▍     | 148/157 [2:11:38<07:59, 53.33s/it]Generating:  95%|███████████████████████████████████████████████████████████████████████████████████████████     | 149/157 [2:12:32<07:07, 53.48s/it]Generating:  96%|███████████████████████████████████████████████████████████████████████████████████████████▋    | 150/157 [2:13:24<06:10, 52.99s/it]Generating:  96%|████████████████████████████████████████████████████████████████████████████████████████████▎   | 151/157 [2:14:18<05:20, 53.38s/it]Generating:  97%|████████████████████████████████████████████████████████████████████████████████████████████▉   | 152/157 [2:15:12<04:27, 53.60s/it]Generating:  97%|█████████████████████████████████████████████████████████████████████████████████████████████▌  | 153/157 [2:16:04<03:31, 52.95s/it]Generating:  98%|██████████████████████████████████████████████████████████████████████████████████████████████▏ | 154/157 [2:16:58<02:39, 53.31s/it]Generating:  99%|██████████████████████████████████████████████████████████████████████████████████████████████▊ | 155/157 [2:17:53<01:47, 53.73s/it]Generating:  99%|███████████████████████████████████████████████████████████████████████████████████████████████▍| 156/157 [2:18:46<00:53, 53.67s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [2:19:06<00:00, 43.44s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [2:19:06<00:00, 53.16s/it]
Fetching 5 files:   0%|                                                                                                        | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 7943.76it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
