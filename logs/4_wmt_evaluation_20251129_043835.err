`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                   | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██████████████████▊                                                        | 1/4 [00:06<00:19,  6.51s/it]Loading checkpoint shards:  50%|█████████████████████████████████████▌                                     | 2/4 [00:12<00:12,  6.09s/it]Loading checkpoint shards:  75%|████████████████████████████████████████████████████████▎                  | 3/4 [00:20<00:06,  6.85s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:21<00:00,  4.89s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:21<00:00,  5.49s/it]
Generating:   0%|                                                                                                 | 0/16 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Generating:   6%|█████▌                                                                                   | 1/16 [00:04<01:12,  4.82s/it]Generating:  12%|███████████▏                                                                             | 2/16 [00:08<00:57,  4.09s/it]Generating:  19%|████████████████▋                                                                        | 3/16 [00:12<00:52,  4.08s/it]Generating:  25%|██████████████████████▎                                                                  | 4/16 [00:16<00:50,  4.20s/it]Generating:  31%|███████████████████████████▊                                                             | 5/16 [00:21<00:47,  4.32s/it]Generating:  38%|█████████████████████████████████▍                                                       | 6/16 [00:25<00:42,  4.26s/it]Generating:  44%|██████████████████████████████████████▉                                                  | 7/16 [00:29<00:37,  4.12s/it]Generating:  50%|████████████████████████████████████████████▌                                            | 8/16 [00:33<00:33,  4.15s/it]Generating:  56%|██████████████████████████████████████████████████                                       | 9/16 [00:37<00:27,  4.00s/it]Generating:  62%|███████████████████████████████████████████████████████                                 | 10/16 [00:40<00:21,  3.65s/it]Generating:  69%|████████████████████████████████████████████████████████████▌                           | 11/16 [00:43<00:18,  3.62s/it]Generating:  75%|██████████████████████████████████████████████████████████████████                      | 12/16 [00:48<00:16,  4.10s/it]Generating:  81%|███████████████████████████████████████████████████████████████████████▌                | 13/16 [00:52<00:11,  3.92s/it]Generating:  88%|█████████████████████████████████████████████████████████████████████████████           | 14/16 [00:55<00:07,  3.83s/it]Generating:  94%|██████████████████████████████████████████████████████████████████████████████████▌     | 15/16 [01:00<00:03,  4.00s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████| 16/16 [01:02<00:00,  3.48s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████| 16/16 [01:02<00:00,  3.91s/it]
Fetching 5 files:   0%|                                                                                            | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|██████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 2165.58it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 4_wmt_evaluation.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
