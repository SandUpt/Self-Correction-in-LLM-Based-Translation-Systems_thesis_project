`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                               | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████████                                                          | 1/3 [00:00<00:01,  1.28it/s]Loading checkpoint shards:  67%|██████████████████████████████████████████████████████████                             | 2/3 [00:01<00:00,  1.24it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.28it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.27it/s]
Generating:   0%|                                                                                                             | 0/16 [00:00<?, ?it/s]Generating:   6%|██████▎                                                                                              | 1/16 [01:00<15:02, 60.14s/it]Generating:  12%|████████████▋                                                                                        | 2/16 [01:58<13:47, 59.12s/it]Generating:  19%|██████████████████▉                                                                                  | 3/16 [02:55<12:34, 58.07s/it]Generating:  25%|█████████████████████████▎                                                                           | 4/16 [03:54<11:42, 58.57s/it]Generating:  31%|███████████████████████████████▌                                                                     | 5/16 [04:49<10:29, 57.25s/it]Generating:  38%|█████████████████████████████████████▉                                                               | 6/16 [05:45<09:28, 56.86s/it]Generating:  44%|████████████████████████████████████████████▏                                                        | 7/16 [06:41<08:27, 56.41s/it]Generating:  50%|██████████████████████████████████████████████████▌                                                  | 8/16 [07:36<07:28, 56.05s/it]Generating:  56%|████████████████████████████████████████████████████████▊                                            | 9/16 [08:34<06:36, 56.66s/it]Generating:  62%|██████████████████████████████████████████████████████████████▌                                     | 10/16 [09:28<05:35, 55.94s/it]Generating:  69%|████████████████████████████████████████████████████████████████████▊                               | 11/16 [10:23<04:38, 55.63s/it]Generating:  75%|███████████████████████████████████████████████████████████████████████████                         | 12/16 [11:20<03:44, 56.11s/it]Generating:  81%|█████████████████████████████████████████████████████████████████████████████████▎                  | 13/16 [12:17<02:48, 56.24s/it]Generating:  88%|███████████████████████████████████████████████████████████████████████████████████████▌            | 14/16 [13:18<01:55, 57.73s/it]Generating:  94%|█████████████████████████████████████████████████████████████████████████████████████████████▊      | 15/16 [14:17<00:58, 58.02s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [14:55<00:00, 52.09s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [14:55<00:00, 55.98s/it]
Fetching 5 files:   0%|                                                                                                        | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 933.77it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_2.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
