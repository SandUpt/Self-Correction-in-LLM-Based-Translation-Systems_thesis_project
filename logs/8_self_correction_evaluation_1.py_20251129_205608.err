`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                               | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████████                                                          | 1/3 [00:00<00:01,  1.03it/s]Loading checkpoint shards:  67%|██████████████████████████████████████████████████████████                             | 2/3 [00:02<00:01,  1.04s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:03<00:00,  1.09s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:03<00:00,  1.07s/it]
Generating:   0%|                                                                                                            | 0/157 [00:00<?, ?it/s]Generating:   1%|▌                                                                                                 | 1/157 [00:54<2:22:34, 54.83s/it]Generating:   1%|█▏                                                                                                | 2/157 [01:48<2:20:36, 54.43s/it]Generating:   2%|█▊                                                                                                | 3/157 [02:43<2:19:36, 54.39s/it]Generating:   3%|██▍                                                                                               | 4/157 [03:36<2:17:49, 54.05s/it]Generating:   3%|███                                                                                               | 5/157 [04:31<2:17:14, 54.18s/it]Generating:   4%|███▋                                                                                              | 6/157 [05:24<2:15:36, 53.88s/it]Generating:   4%|████▎                                                                                             | 7/157 [06:20<2:16:04, 54.43s/it]Generating:   5%|████▉                                                                                             | 8/157 [07:15<2:15:41, 54.64s/it]Generating:   6%|█████▌                                                                                            | 9/157 [08:09<2:14:27, 54.51s/it]Generating:   6%|██████▏                                                                                          | 10/157 [09:04<2:14:06, 54.74s/it]Generating:   7%|██████▊                                                                                          | 11/157 [09:57<2:11:32, 54.06s/it]Generating:   8%|███████▍                                                                                         | 12/157 [10:52<2:11:16, 54.32s/it]Generating:   8%|████████                                                                                         | 13/157 [11:49<2:12:40, 55.28s/it]Generating:   9%|████████▋                                                                                        | 14/157 [12:43<2:11:03, 54.99s/it]Generating:  10%|█████████▎                                                                                       | 15/157 [13:38<2:09:33, 54.75s/it]Generating:  10%|█████████▉                                                                                       | 16/157 [14:32<2:08:15, 54.58s/it]Generating:  11%|██████████▌                                                                                      | 17/157 [15:27<2:07:43, 54.74s/it]Generating:  11%|███████████                                                                                      | 18/157 [16:21<2:06:31, 54.62s/it]Generating:  12%|███████████▋                                                                                     | 19/157 [17:17<2:06:27, 54.99s/it]Generating:  13%|████████████▎                                                                                    | 20/157 [18:12<2:05:30, 54.97s/it]Generating:  13%|████████████▉                                                                                    | 21/157 [19:07<2:04:53, 55.10s/it]Generating:  14%|█████████████▌                                                                                   | 22/157 [20:03<2:03:58, 55.10s/it]Generating:  15%|██████████████▏                                                                                  | 23/157 [20:59<2:03:46, 55.42s/it]Generating:  15%|██████████████▊                                                                                  | 24/157 [21:52<2:01:25, 54.77s/it]Generating:  16%|███████████████▍                                                                                 | 25/157 [22:48<2:01:18, 55.14s/it]Generating:  17%|████████████████                                                                                 | 26/157 [23:42<1:59:46, 54.86s/it]Generating:  17%|████████████████▋                                                                                | 27/157 [24:37<1:58:55, 54.89s/it]Generating:  18%|█████████████████▎                                                                               | 28/157 [25:31<1:57:03, 54.45s/it]Generating:  18%|█████████████████▉                                                                               | 29/157 [26:24<1:55:42, 54.23s/it]Generating:  19%|██████████████████▌                                                                              | 30/157 [27:21<1:56:05, 54.85s/it]Generating:  20%|███████████████████▏                                                                             | 31/157 [28:14<1:54:00, 54.29s/it]Generating:  20%|███████████████████▊                                                                             | 32/157 [29:08<1:53:13, 54.35s/it]Generating:  21%|████████████████████▍                                                                            | 33/157 [30:03<1:52:41, 54.52s/it]Generating:  22%|█████████████████████                                                                            | 34/157 [30:58<1:52:14, 54.75s/it]Generating:  22%|█████████████████████▌                                                                           | 35/157 [31:54<1:52:10, 55.17s/it]Generating:  23%|██████████████████████▏                                                                          | 36/157 [32:50<1:51:33, 55.32s/it]Generating:  24%|██████████████████████▊                                                                          | 37/157 [33:44<1:49:40, 54.84s/it]Generating:  24%|███████████████████████▍                                                                         | 38/157 [34:37<1:47:49, 54.37s/it]Generating:  25%|████████████████████████                                                                         | 39/157 [35:29<1:45:44, 53.77s/it]Generating:  25%|████████████████████████▋                                                                        | 40/157 [36:25<1:45:37, 54.17s/it]Generating:  26%|█████████████████████████▎                                                                       | 41/157 [37:21<1:45:51, 54.76s/it]Generating:  27%|█████████████████████████▉                                                                       | 42/157 [38:13<1:43:49, 54.17s/it]Generating:  27%|██████████████████████████▌                                                                      | 43/157 [39:08<1:43:20, 54.39s/it]Generating:  28%|███████████████████████████▏                                                                     | 44/157 [40:03<1:42:45, 54.56s/it]Generating:  29%|███████████████████████████▊                                                                     | 45/157 [40:57<1:41:37, 54.44s/it]Generating:  29%|████████████████████████████▍                                                                    | 46/157 [41:53<1:41:17, 54.75s/it]Generating:  30%|█████████████████████████████                                                                    | 47/157 [42:47<1:39:43, 54.40s/it]Generating:  31%|█████████████████████████████▋                                                                   | 48/157 [43:42<1:39:35, 54.82s/it]Generating:  31%|██████████████████████████████▎                                                                  | 49/157 [44:38<1:39:12, 55.12s/it]Generating:  32%|██████████████████████████████▉                                                                  | 50/157 [45:34<1:38:39, 55.33s/it]Generating:  32%|███████████████████████████████▌                                                                 | 51/157 [46:29<1:37:26, 55.16s/it]Generating:  33%|████████████████████████████████▏                                                                | 52/157 [47:22<1:35:27, 54.55s/it]Generating:  34%|████████████████████████████████▋                                                                | 53/157 [48:16<1:34:35, 54.57s/it]Generating:  34%|█████████████████████████████████▎                                                               | 54/157 [49:11<1:33:37, 54.54s/it]Generating:  35%|█████████████████████████████████▉                                                               | 55/157 [50:05<1:32:14, 54.26s/it]Generating:  36%|██████████████████████████████████▌                                                              | 56/157 [51:01<1:32:33, 54.98s/it]Generating:  36%|███████████████████████████████████▏                                                             | 57/157 [51:57<1:31:58, 55.18s/it]Generating:  37%|███████████████████████████████████▊                                                             | 58/157 [52:51<1:30:36, 54.92s/it]Generating:  38%|████████████████████████████████████▍                                                            | 59/157 [53:46<1:29:33, 54.83s/it]Generating:  38%|█████████████████████████████████████                                                            | 60/157 [54:39<1:27:57, 54.41s/it]Generating:  39%|█████████████████████████████████████▋                                                           | 61/157 [55:34<1:27:23, 54.62s/it]Generating:  39%|██████████████████████████████████████▎                                                          | 62/157 [56:29<1:26:28, 54.62s/it]Generating:  40%|██████████████████████████████████████▉                                                          | 63/157 [57:23<1:25:31, 54.59s/it]Generating:  41%|███████████████████████████████████████▌                                                         | 64/157 [58:19<1:24:54, 54.78s/it]Generating:  41%|████████████████████████████████████████▏                                                        | 65/157 [59:15<1:24:50, 55.33s/it]Generating:  42%|███████████████████████████████████████▉                                                       | 66/157 [1:00:10<1:23:36, 55.12s/it]Generating:  43%|████████████████████████████████████████▌                                                      | 67/157 [1:01:05<1:22:47, 55.20s/it]Generating:  43%|█████████████████████████████████████████▏                                                     | 68/157 [1:02:01<1:22:13, 55.43s/it]Generating:  44%|█████████████████████████████████████████▊                                                     | 69/157 [1:02:55<1:20:28, 54.87s/it]Generating:  45%|██████████████████████████████████████████▎                                                    | 70/157 [1:03:49<1:19:23, 54.75s/it]Generating:  45%|██████████████████████████████████████████▉                                                    | 71/157 [1:04:46<1:19:08, 55.21s/it]Generating:  46%|███████████████████████████████████████████▌                                                   | 72/157 [1:05:40<1:18:01, 55.08s/it]Generating:  46%|████████████████████████████████████████████▏                                                  | 73/157 [1:06:36<1:17:25, 55.30s/it]Generating:  47%|████████████████████████████████████████████▊                                                  | 74/157 [1:07:31<1:16:09, 55.05s/it]Generating:  48%|█████████████████████████████████████████████▍                                                 | 75/157 [1:08:27<1:15:40, 55.38s/it]Generating:  48%|█████████████████████████████████████████████▉                                                 | 76/157 [1:09:21<1:14:28, 55.17s/it]Generating:  49%|██████████████████████████████████████████████▌                                                | 77/157 [1:10:15<1:12:54, 54.69s/it]Generating:  50%|███████████████████████████████████████████████▏                                               | 78/157 [1:11:10<1:12:05, 54.76s/it]Generating:  50%|███████████████████████████████████████████████▊                                               | 79/157 [1:12:04<1:10:57, 54.59s/it]Generating:  51%|████████████████████████████████████████████████▍                                              | 80/157 [1:12:58<1:09:43, 54.33s/it]Generating:  52%|█████████████████████████████████████████████████                                              | 81/157 [1:13:52<1:08:37, 54.18s/it]Generating:  52%|█████████████████████████████████████████████████▌                                             | 82/157 [1:14:47<1:08:13, 54.58s/it]Generating:  53%|██████████████████████████████████████████████████▏                                            | 83/157 [1:15:43<1:07:36, 54.82s/it]Generating:  54%|██████████████████████████████████████████████████▊                                            | 84/157 [1:16:39<1:07:26, 55.44s/it]Generating:  54%|███████████████████████████████████████████████████▍                                           | 85/157 [1:17:36<1:06:55, 55.78s/it]Generating:  55%|████████████████████████████████████████████████████                                           | 86/157 [1:18:30<1:05:13, 55.11s/it]Generating:  55%|████████████████████████████████████████████████████▋                                          | 87/157 [1:19:27<1:04:58, 55.69s/it]Generating:  56%|█████████████████████████████████████████████████████▏                                         | 88/157 [1:20:20<1:03:05, 54.87s/it]Generating:  57%|█████████████████████████████████████████████████████▊                                         | 89/157 [1:21:13<1:01:41, 54.43s/it]Generating:  57%|██████████████████████████████████████████████████████▍                                        | 90/157 [1:22:07<1:00:47, 54.44s/it]Generating:  58%|███████████████████████████████████████████████████████                                        | 91/157 [1:23:05<1:00:50, 55.32s/it]Generating:  59%|████████████████████████████████████████████████████████▊                                        | 92/157 [1:23:59<59:30, 54.93s/it]Generating:  59%|█████████████████████████████████████████████████████████▍                                       | 93/157 [1:24:51<57:36, 54.01s/it]Generating:  60%|██████████████████████████████████████████████████████████                                       | 94/157 [1:25:46<57:13, 54.51s/it]Generating:  61%|██████████████████████████████████████████████████████████▋                                      | 95/157 [1:26:41<56:15, 54.45s/it]Generating:  61%|███████████████████████████████████████████████████████████▎                                     | 96/157 [1:27:36<55:35, 54.68s/it]Generating:  62%|███████████████████████████████████████████████████████████▉                                     | 97/157 [1:28:30<54:28, 54.48s/it]Generating:  62%|████████████████████████████████████████████████████████████▌                                    | 98/157 [1:29:25<53:42, 54.63s/it]Generating:  63%|█████████████████████████████████████████████████████████████▏                                   | 99/157 [1:30:18<52:21, 54.16s/it]Generating:  64%|█████████████████████████████████████████████████████████████▏                                  | 100/157 [1:31:13<51:47, 54.52s/it]Generating:  64%|█████████████████████████████████████████████████████████████▊                                  | 101/157 [1:32:06<50:19, 53.92s/it]Generating:  65%|██████████████████████████████████████████████████████████████▎                                 | 102/157 [1:32:59<49:09, 53.63s/it]Generating:  66%|██████████████████████████████████████████████████████████████▉                                 | 103/157 [1:33:56<49:06, 54.56s/it]Generating:  66%|███████████████████████████████████████████████████████████████▌                                | 104/157 [1:34:51<48:29, 54.89s/it]Generating:  67%|████████████████████████████████████████████████████████████████▏                               | 105/157 [1:35:45<47:22, 54.67s/it]Generating:  68%|████████████████████████████████████████████████████████████████▊                               | 106/157 [1:36:40<46:22, 54.56s/it]Generating:  68%|█████████████████████████████████████████████████████████████████▍                              | 107/157 [1:37:34<45:28, 54.58s/it]Generating:  69%|██████████████████████████████████████████████████████████████████                              | 108/157 [1:38:30<44:46, 54.82s/it]Generating:  69%|██████████████████████████████████████████████████████████████████▋                             | 109/157 [1:39:24<43:37, 54.54s/it]Generating:  70%|███████████████████████████████████████████████████████████████████▎                            | 110/157 [1:40:18<42:38, 54.43s/it]Generating:  71%|███████████████████████████████████████████████████████████████████▊                            | 111/157 [1:41:13<41:58, 54.76s/it]Generating:  71%|████████████████████████████████████████████████████████████████████▍                           | 112/157 [1:42:08<41:04, 54.77s/it]Generating:  72%|█████████████████████████████████████████████████████████████████████                           | 113/157 [1:43:01<39:47, 54.27s/it]Generating:  73%|█████████████████████████████████████████████████████████████████████▋                          | 114/157 [1:43:56<38:56, 54.33s/it]Generating:  73%|██████████████████████████████████████████████████████████████████████▎                         | 115/157 [1:44:51<38:13, 54.60s/it]Generating:  74%|██████████████████████████████████████████████████████████████████████▉                         | 116/157 [1:45:45<37:07, 54.33s/it]Generating:  75%|███████████████████████████████████████████████████████████████████████▌                        | 117/157 [1:46:40<36:27, 54.69s/it]Generating:  75%|████████████████████████████████████████████████████████████████████████▏                       | 118/157 [1:47:35<35:34, 54.72s/it]Generating:  76%|████████████████████████████████████████████████████████████████████████▊                       | 119/157 [1:48:30<34:47, 54.93s/it]Generating:  76%|█████████████████████████████████████████████████████████████████████████▍                      | 120/157 [1:49:24<33:39, 54.57s/it]Generating:  77%|█████████████████████████████████████████████████████████████████████████▉                      | 121/157 [1:50:19<32:47, 54.64s/it]Generating:  78%|██████████████████████████████████████████████████████████████████████████▌                     | 122/157 [1:51:14<32:00, 54.87s/it]Generating:  78%|███████████████████████████████████████████████████████████████████████████▏                    | 123/157 [1:52:07<30:44, 54.25s/it]Generating:  79%|███████████████████████████████████████████████████████████████████████████▊                    | 124/157 [1:52:59<29:28, 53.60s/it]Generating:  80%|████████████████████████████████████████████████████████████████████████████▍                   | 125/157 [1:53:53<28:38, 53.71s/it]Generating:  80%|█████████████████████████████████████████████████████████████████████████████                   | 126/157 [1:54:48<27:59, 54.16s/it]Generating:  81%|█████████████████████████████████████████████████████████████████████████████▋                  | 127/157 [1:55:44<27:18, 54.61s/it]Generating:  82%|██████████████████████████████████████████████████████████████████████████████▎                 | 128/157 [1:56:37<26:12, 54.21s/it]Generating:  82%|██████████████████████████████████████████████████████████████████████████████▉                 | 129/157 [1:57:31<25:11, 53.97s/it]Generating:  83%|███████████████████████████████████████████████████████████████████████████████▍                | 130/157 [1:58:23<24:08, 53.63s/it]Generating:  83%|████████████████████████████████████████████████████████████████████████████████                | 131/157 [1:59:19<23:29, 54.20s/it]Generating:  84%|████████████████████████████████████████████████████████████████████████████████▋               | 132/157 [2:00:12<22:23, 53.74s/it]Generating:  85%|█████████████████████████████████████████████████████████████████████████████████▎              | 133/157 [2:01:05<21:25, 53.55s/it]Generating:  85%|█████████████████████████████████████████████████████████████████████████████████▉              | 134/157 [2:02:01<20:49, 54.32s/it]Generating:  86%|██████████████████████████████████████████████████████████████████████████████████▌             | 135/157 [2:02:55<19:55, 54.36s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████▏            | 136/157 [2:03:52<19:13, 54.93s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████▊            | 137/157 [2:04:47<18:21, 55.06s/it]Generating:  88%|████████████████████████████████████████████████████████████████████████████████████▍           | 138/157 [2:05:41<17:18, 54.66s/it]Generating:  89%|████████████████████████████████████████████████████████████████████████████████████▉           | 139/157 [2:06:33<16:13, 54.06s/it]Generating:  89%|█████████████████████████████████████████████████████████████████████████████████████▌          | 140/157 [2:07:28<15:22, 54.29s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████▏         | 141/157 [2:08:24<14:34, 54.67s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████▊         | 142/157 [2:09:19<13:41, 54.80s/it]Generating:  91%|███████████████████████████████████████████████████████████████████████████████████████▍        | 143/157 [2:10:13<12:45, 54.71s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████        | 144/157 [2:11:09<11:53, 54.92s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████▋       | 145/157 [2:12:03<10:57, 54.83s/it]Generating:  93%|█████████████████████████████████████████████████████████████████████████████████████████▎      | 146/157 [2:12:59<10:05, 55.04s/it]Generating:  94%|█████████████████████████████████████████████████████████████████████████████████████████▉      | 147/157 [2:13:54<09:09, 54.91s/it]Generating:  94%|██████████████████████████████████████████████████████████████████████████████████████████▍     | 148/157 [2:14:48<08:12, 54.73s/it]Generating:  95%|███████████████████████████████████████████████████████████████████████████████████████████     | 149/157 [2:15:43<07:19, 54.93s/it]Generating:  96%|███████████████████████████████████████████████████████████████████████████████████████████▋    | 150/157 [2:16:36<06:20, 54.29s/it]Generating:  96%|████████████████████████████████████████████████████████████████████████████████████████████▎   | 151/157 [2:17:32<05:28, 54.81s/it]Generating:  97%|████████████████████████████████████████████████████████████████████████████████████████████▉   | 152/157 [2:18:27<04:34, 54.94s/it]Generating:  97%|█████████████████████████████████████████████████████████████████████████████████████████████▌  | 153/157 [2:19:20<03:37, 54.25s/it]Generating:  98%|██████████████████████████████████████████████████████████████████████████████████████████████▏ | 154/157 [2:20:16<02:44, 54.72s/it]Generating:  99%|██████████████████████████████████████████████████████████████████████████████████████████████▊ | 155/157 [2:21:13<01:50, 55.37s/it]Generating:  99%|███████████████████████████████████████████████████████████████████████████████████████████████▍| 156/157 [2:22:07<00:54, 54.97s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [2:22:26<00:00, 44.34s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [2:22:26<00:00, 54.44s/it]
Fetching 5 files:   0%|                                                                                                        | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 3082.23it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
