`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                               | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|█████████████████████▊                                                                 | 1/4 [00:00<00:02,  1.46it/s]Loading checkpoint shards:  50%|███████████████████████████████████████████▌                                           | 2/4 [00:01<00:01,  1.46it/s]Loading checkpoint shards:  75%|█████████████████████████████████████████████████████████████████▎                     | 3/4 [00:02<00:00,  1.47it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  2.10it/s]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.81it/s]
Generating:   0%|                                                                                                            | 0/157 [00:00<?, ?it/s]The following generation flags are not valid and may be ignored: ['temperature', 'top_p']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Generating:   1%|▌                                                                                                 | 1/157 [00:53<2:20:19, 53.97s/it]Generating:   1%|█▏                                                                                                | 2/157 [01:50<2:23:02, 55.37s/it]Generating:   2%|█▊                                                                                                | 3/157 [02:43<2:19:06, 54.20s/it]Generating:   3%|██▍                                                                                               | 4/157 [03:38<2:19:19, 54.64s/it]Generating:   3%|███                                                                                               | 5/157 [04:31<2:16:47, 54.00s/it]Generating:   4%|███▋                                                                                              | 6/157 [05:25<2:15:41, 53.92s/it]Generating:   4%|████▎                                                                                             | 7/157 [06:17<2:13:53, 53.56s/it]Generating:   5%|████▉                                                                                             | 8/157 [07:12<2:13:28, 53.75s/it]Generating:   6%|█████▌                                                                                            | 9/157 [08:06<2:12:47, 53.84s/it]Generating:   6%|██████▏                                                                                          | 10/157 [08:58<2:10:57, 53.45s/it]Generating:   7%|██████▊                                                                                          | 11/157 [09:51<2:09:19, 53.15s/it]Generating:   8%|███████▍                                                                                         | 12/157 [10:44<2:08:36, 53.22s/it]Generating:   8%|████████                                                                                         | 13/157 [11:40<2:09:23, 53.91s/it]Generating:   9%|████████▋                                                                                        | 14/157 [12:34<2:09:03, 54.15s/it]Generating:  10%|█████████▎                                                                                       | 15/157 [13:30<2:09:06, 54.55s/it]Generating:  10%|█████████▉                                                                                       | 16/157 [14:23<2:07:21, 54.19s/it]Generating:  11%|██████████▌                                                                                      | 17/157 [15:18<2:06:42, 54.30s/it]Generating:  11%|███████████                                                                                      | 18/157 [16:11<2:05:22, 54.12s/it]Generating:  12%|███████████▋                                                                                     | 19/157 [17:07<2:05:24, 54.53s/it]Generating:  13%|████████████▎                                                                                    | 20/157 [18:00<2:03:55, 54.27s/it]Generating:  13%|████████████▉                                                                                    | 21/157 [18:58<2:05:12, 55.24s/it]Generating:  14%|█████████████▌                                                                                   | 22/157 [19:56<2:06:29, 56.22s/it]Generating:  15%|██████████████▏                                                                                  | 23/157 [20:49<2:03:01, 55.09s/it]Generating:  15%|██████████████▊                                                                                  | 24/157 [21:42<2:00:46, 54.49s/it]Generating:  16%|███████████████▍                                                                                 | 25/157 [22:36<1:59:36, 54.37s/it]Generating:  17%|████████████████                                                                                 | 26/157 [23:29<1:57:50, 53.97s/it]Generating:  17%|████████████████▋                                                                                | 27/157 [24:24<1:57:31, 54.25s/it]Generating:  18%|█████████████████▎                                                                               | 28/157 [25:19<1:57:19, 54.57s/it]Generating:  18%|█████████████████▉                                                                               | 29/157 [26:16<1:58:03, 55.34s/it]Generating:  19%|██████████████████▌                                                                              | 30/157 [27:09<1:55:17, 54.47s/it]Generating:  20%|███████████████████▏                                                                             | 31/157 [28:02<1:53:48, 54.19s/it]Generating:  20%|███████████████████▊                                                                             | 32/157 [28:55<1:51:42, 53.62s/it]Generating:  21%|████████████████████▍                                                                            | 33/157 [29:49<1:51:17, 53.85s/it]Generating:  22%|█████████████████████                                                                            | 34/157 [30:43<1:50:39, 53.98s/it]Generating:  22%|█████████████████████▌                                                                           | 35/157 [31:37<1:49:22, 53.79s/it]Generating:  23%|██████████████████████▏                                                                          | 36/157 [32:31<1:48:29, 53.80s/it]Generating:  24%|██████████████████████▊                                                                          | 37/157 [33:23<1:46:57, 53.48s/it]Generating:  24%|███████████████████████▍                                                                         | 38/157 [34:19<1:47:31, 54.22s/it]Generating:  25%|████████████████████████                                                                         | 39/157 [35:12<1:45:50, 53.82s/it]Generating:  25%|████████████████████████▋                                                                        | 40/157 [36:05<1:44:39, 53.67s/it]Generating:  26%|█████████████████████████▎                                                                       | 41/157 [36:57<1:42:36, 53.07s/it]Generating:  27%|█████████████████████████▉                                                                       | 42/157 [37:50<1:41:31, 52.97s/it]Generating:  27%|██████████████████████████▌                                                                      | 43/157 [38:44<1:41:23, 53.36s/it]Generating:  28%|███████████████████████████▏                                                                     | 44/157 [39:38<1:40:50, 53.54s/it]Generating:  29%|███████████████████████████▊                                                                     | 45/157 [40:31<1:39:20, 53.22s/it]Generating:  29%|████████████████████████████▍                                                                    | 46/157 [41:23<1:37:54, 52.93s/it]Generating:  30%|█████████████████████████████                                                                    | 47/157 [42:16<1:37:09, 53.00s/it]Generating:  31%|█████████████████████████████▋                                                                   | 48/157 [43:09<1:36:02, 52.87s/it]Generating:  31%|██████████████████████████████▎                                                                  | 49/157 [44:00<1:34:25, 52.46s/it]Generating:  32%|██████████████████████████████▉                                                                  | 50/157 [44:52<1:33:31, 52.45s/it]Generating:  32%|███████████████████████████████▌                                                                 | 51/157 [45:46<1:33:07, 52.71s/it]Generating:  33%|████████████████████████████████▏                                                                | 52/157 [46:39<1:32:19, 52.76s/it]Generating:  34%|████████████████████████████████▋                                                                | 53/157 [47:35<1:33:15, 53.80s/it]Generating:  34%|█████████████████████████████████▎                                                               | 54/157 [48:28<1:31:48, 53.48s/it]Generating:  35%|█████████████████████████████████▉                                                               | 55/157 [49:20<1:30:27, 53.21s/it]Generating:  36%|██████████████████████████████████▌                                                              | 56/157 [50:14<1:29:48, 53.35s/it]Generating:  36%|███████████████████████████████████▏                                                             | 57/157 [51:08<1:29:03, 53.44s/it]Generating:  37%|███████████████████████████████████▊                                                             | 58/157 [52:01<1:28:25, 53.59s/it]Generating:  38%|████████████████████████████████████▍                                                            | 59/157 [52:54<1:27:02, 53.29s/it]Generating:  38%|█████████████████████████████████████                                                            | 60/157 [53:46<1:25:39, 52.98s/it]Generating:  39%|█████████████████████████████████████▋                                                           | 61/157 [54:40<1:24:58, 53.10s/it]Generating:  39%|██████████████████████████████████████▎                                                          | 62/157 [55:33<1:24:20, 53.27s/it]Generating:  40%|██████████████████████████████████████▉                                                          | 63/157 [56:27<1:23:38, 53.39s/it]Generating:  41%|███████████████████████████████████████▌                                                         | 64/157 [57:20<1:22:39, 53.33s/it]Generating:  41%|████████████████████████████████████████▏                                                        | 65/157 [58:12<1:20:55, 52.78s/it]Generating:  42%|████████████████████████████████████████▊                                                        | 66/157 [59:05<1:20:22, 52.99s/it]Generating:  43%|█████████████████████████████████████████▍                                                       | 67/157 [59:59<1:19:52, 53.25s/it]Generating:  43%|█████████████████████████████████████████▏                                                     | 68/157 [1:00:53<1:19:30, 53.60s/it]Generating:  44%|█████████████████████████████████████████▊                                                     | 69/157 [1:01:47<1:18:45, 53.70s/it]Generating:  45%|██████████████████████████████████████████▎                                                    | 70/157 [1:02:42<1:18:15, 53.97s/it]Generating:  45%|██████████████████████████████████████████▉                                                    | 71/157 [1:03:35<1:16:49, 53.60s/it]Generating:  46%|███████████████████████████████████████████▌                                                   | 72/157 [1:04:29<1:16:24, 53.94s/it]Generating:  46%|████████████████████████████████████████████▏                                                  | 73/157 [1:05:22<1:14:49, 53.44s/it]Generating:  47%|████████████████████████████████████████████▊                                                  | 74/157 [1:06:16<1:14:08, 53.60s/it]Generating:  48%|█████████████████████████████████████████████▍                                                 | 75/157 [1:07:09<1:13:15, 53.61s/it]Generating:  48%|█████████████████████████████████████████████▉                                                 | 76/157 [1:08:02<1:11:53, 53.25s/it]Generating:  49%|██████████████████████████████████████████████▌                                                | 77/157 [1:08:55<1:10:48, 53.11s/it]Generating:  50%|███████████████████████████████████████████████▏                                               | 78/157 [1:09:49<1:10:34, 53.60s/it]Generating:  50%|███████████████████████████████████████████████▊                                               | 79/157 [1:10:42<1:09:23, 53.38s/it]Generating:  51%|████████████████████████████████████████████████▍                                              | 80/157 [1:11:39<1:09:54, 54.47s/it]Generating:  52%|█████████████████████████████████████████████████                                              | 81/157 [1:12:35<1:09:30, 54.87s/it]Generating:  52%|█████████████████████████████████████████████████▌                                             | 82/157 [1:13:28<1:07:44, 54.19s/it]Generating:  53%|██████████████████████████████████████████████████▏                                            | 83/157 [1:14:22<1:07:05, 54.39s/it]Generating:  54%|██████████████████████████████████████████████████▊                                            | 84/157 [1:15:16<1:05:47, 54.08s/it]Generating:  54%|███████████████████████████████████████████████████▍                                           | 85/157 [1:16:09<1:04:31, 53.77s/it]Generating:  55%|████████████████████████████████████████████████████                                           | 86/157 [1:17:02<1:03:34, 53.73s/it]Generating:  55%|████████████████████████████████████████████████████▋                                          | 87/157 [1:17:56<1:02:39, 53.71s/it]Generating:  56%|█████████████████████████████████████████████████████▏                                         | 88/157 [1:18:49<1:01:25, 53.42s/it]Generating:  57%|█████████████████████████████████████████████████████▊                                         | 89/157 [1:19:45<1:01:27, 54.23s/it]Generating:  57%|██████████████████████████████████████████████████████▍                                        | 90/157 [1:20:38<1:00:06, 53.83s/it]Generating:  58%|████████████████████████████████████████████████████████▏                                        | 91/157 [1:21:31<59:01, 53.66s/it]Generating:  59%|████████████████████████████████████████████████████████▊                                        | 92/157 [1:22:23<57:40, 53.24s/it]Generating:  59%|█████████████████████████████████████████████████████████▍                                       | 93/157 [1:23:17<56:55, 53.36s/it]Generating:  60%|██████████████████████████████████████████████████████████                                       | 94/157 [1:24:10<55:56, 53.27s/it]Generating:  61%|██████████████████████████████████████████████████████████▋                                      | 95/157 [1:25:05<55:29, 53.71s/it]Generating:  61%|███████████████████████████████████████████████████████████▎                                     | 96/157 [1:25:58<54:18, 53.42s/it]Generating:  62%|███████████████████████████████████████████████████████████▉                                     | 97/157 [1:26:51<53:24, 53.40s/it]Generating:  62%|████████████████████████████████████████████████████████████▌                                    | 98/157 [1:27:47<53:10, 54.07s/it]Generating:  63%|█████████████████████████████████████████████████████████████▏                                   | 99/157 [1:28:43<52:51, 54.68s/it]Generating:  64%|█████████████████████████████████████████████████████████████▏                                  | 100/157 [1:29:35<51:11, 53.88s/it]Generating:  64%|█████████████████████████████████████████████████████████████▊                                  | 101/157 [1:30:30<50:41, 54.31s/it]Generating:  65%|██████████████████████████████████████████████████████████████▎                                 | 102/157 [1:31:24<49:36, 54.12s/it]Generating:  66%|██████████████████████████████████████████████████████████████▉                                 | 103/157 [1:32:17<48:22, 53.75s/it]Generating:  66%|███████████████████████████████████████████████████████████████▌                                | 104/157 [1:33:11<47:41, 53.99s/it]Generating:  67%|████████████████████████████████████████████████████████████████▏                               | 105/157 [1:34:04<46:32, 53.71s/it]Generating:  68%|████████████████████████████████████████████████████████████████▊                               | 106/157 [1:34:58<45:38, 53.69s/it]Generating:  68%|█████████████████████████████████████████████████████████████████▍                              | 107/157 [1:35:54<45:16, 54.32s/it]Generating:  69%|██████████████████████████████████████████████████████████████████                              | 108/157 [1:36:48<44:18, 54.25s/it]Generating:  69%|██████████████████████████████████████████████████████████████████▋                             | 109/157 [1:37:41<43:04, 53.85s/it]Generating:  70%|███████████████████████████████████████████████████████████████████▎                            | 110/157 [1:38:34<42:08, 53.80s/it]Generating:  71%|███████████████████████████████████████████████████████████████████▊                            | 111/157 [1:39:28<41:10, 53.70s/it]Generating:  71%|████████████████████████████████████████████████████████████████████▍                           | 112/157 [1:40:21<40:03, 53.42s/it]Generating:  72%|█████████████████████████████████████████████████████████████████████                           | 113/157 [1:41:13<38:55, 53.07s/it]Generating:  73%|█████████████████████████████████████████████████████████████████████▋                          | 114/157 [1:42:04<37:43, 52.64s/it]Generating:  73%|██████████████████████████████████████████████████████████████████████▎                         | 115/157 [1:42:59<37:13, 53.18s/it]Generating:  74%|██████████████████████████████████████████████████████████████████████▉                         | 116/157 [1:43:53<36:35, 53.55s/it]Generating:  75%|███████████████████████████████████████████████████████████████████████▌                        | 117/157 [1:44:46<35:37, 53.44s/it]Generating:  75%|████████████████████████████████████████████████████████████████████████▏                       | 118/157 [1:45:39<34:28, 53.04s/it]Generating:  76%|████████████████████████████████████████████████████████████████████████▊                       | 119/157 [1:46:31<33:23, 52.72s/it]Generating:  76%|█████████████████████████████████████████████████████████████████████████▍                      | 120/157 [1:47:24<32:39, 52.95s/it]Generating:  77%|█████████████████████████████████████████████████████████████████████████▉                      | 121/157 [1:48:19<32:02, 53.40s/it]Generating:  78%|██████████████████████████████████████████████████████████████████████████▌                     | 122/157 [1:49:12<31:08, 53.38s/it]Generating:  78%|███████████████████████████████████████████████████████████████████████████▏                    | 123/157 [1:50:05<30:14, 53.37s/it]Generating:  79%|███████████████████████████████████████████████████████████████████████████▊                    | 124/157 [1:50:58<29:13, 53.13s/it]Generating:  80%|████████████████████████████████████████████████████████████████████████████▍                   | 125/157 [1:51:52<28:32, 53.51s/it]Generating:  80%|█████████████████████████████████████████████████████████████████████████████                   | 126/157 [1:52:46<27:45, 53.73s/it]Generating:  81%|█████████████████████████████████████████████████████████████████████████████▋                  | 127/157 [1:53:41<26:57, 53.93s/it]Generating:  82%|██████████████████████████████████████████████████████████████████████████████▎                 | 128/157 [1:54:36<26:14, 54.30s/it]Generating:  82%|██████████████████████████████████████████████████████████████████████████████▉                 | 129/157 [1:55:31<25:26, 54.51s/it]Generating:  83%|███████████████████████████████████████████████████████████████████████████████▍                | 130/157 [1:56:26<24:34, 54.62s/it]Generating:  83%|████████████████████████████████████████████████████████████████████████████████                | 131/157 [1:57:21<23:46, 54.87s/it]Generating:  84%|████████████████████████████████████████████████████████████████████████████████▋               | 132/157 [1:58:16<22:50, 54.84s/it]Generating:  85%|█████████████████████████████████████████████████████████████████████████████████▎              | 133/157 [1:59:09<21:42, 54.25s/it]Generating:  85%|█████████████████████████████████████████████████████████████████████████████████▉              | 134/157 [2:00:01<20:32, 53.60s/it]Generating:  86%|██████████████████████████████████████████████████████████████████████████████████▌             | 135/157 [2:00:54<19:37, 53.52s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████▏            | 136/157 [2:01:48<18:45, 53.61s/it]Generating:  87%|███████████████████████████████████████████████████████████████████████████████████▊            | 137/157 [2:02:42<17:52, 53.62s/it]Generating:  88%|████████████████████████████████████████████████████████████████████████████████████▍           | 138/157 [2:03:35<16:58, 53.58s/it]Generating:  89%|████████████████████████████████████████████████████████████████████████████████████▉           | 139/157 [2:04:29<16:05, 53.65s/it]Generating:  89%|█████████████████████████████████████████████████████████████████████████████████████▌          | 140/157 [2:05:21<15:03, 53.15s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████▏         | 141/157 [2:06:14<14:06, 52.93s/it]Generating:  90%|██████████████████████████████████████████████████████████████████████████████████████▊         | 142/157 [2:07:08<13:21, 53.46s/it]Generating:  91%|███████████████████████████████████████████████████████████████████████████████████████▍        | 143/157 [2:08:00<12:21, 52.94s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████        | 144/157 [2:08:54<11:32, 53.24s/it]Generating:  92%|████████████████████████████████████████████████████████████████████████████████████████▋       | 145/157 [2:09:47<10:38, 53.22s/it]Generating:  93%|█████████████████████████████████████████████████████████████████████████████████████████▎      | 146/157 [2:10:41<09:46, 53.30s/it]Generating:  94%|█████████████████████████████████████████████████████████████████████████████████████████▉      | 147/157 [2:11:34<08:52, 53.26s/it]Generating:  94%|██████████████████████████████████████████████████████████████████████████████████████████▍     | 148/157 [2:12:27<08:00, 53.37s/it]Generating:  95%|███████████████████████████████████████████████████████████████████████████████████████████     | 149/157 [2:13:23<07:12, 54.00s/it]Generating:  96%|███████████████████████████████████████████████████████████████████████████████████████████▋    | 150/157 [2:14:16<06:16, 53.76s/it]Generating:  96%|████████████████████████████████████████████████████████████████████████████████████████████▎   | 151/157 [2:15:10<05:23, 53.90s/it]Generating:  97%|████████████████████████████████████████████████████████████████████████████████████████████▉   | 152/157 [2:16:02<04:26, 53.23s/it]Generating:  97%|█████████████████████████████████████████████████████████████████████████████████████████████▌  | 153/157 [2:16:55<03:32, 53.17s/it]Generating:  98%|██████████████████████████████████████████████████████████████████████████████████████████████▏ | 154/157 [2:17:47<02:38, 52.86s/it]Generating:  99%|██████████████████████████████████████████████████████████████████████████████████████████████▊ | 155/157 [2:18:43<01:47, 53.78s/it]Generating:  99%|███████████████████████████████████████████████████████████████████████████████████████████████▍| 156/157 [2:19:38<00:54, 54.06s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [2:19:57<00:00, 43.74s/it]Generating: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [2:19:57<00:00, 53.49s/it]
Fetching 5 files:   0%|                                                                                                        | 0/5 [00:00<?, ?it/s]Fetching 5 files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 2954.15it/s]
Lightning automatically upgraded your loaded checkpoint from v1.8.3.post1 to v2.5.1.post0. To apply the upgrade to your files permanently, run `python -m pytorch_lightning.utilities.upgrade_checkpoint ../../../../.cache/huggingface/hub/models--Unbabel--wmt22-comet-da/snapshots/2760a223ac957f30acfb18c8aa649b01cf1d75f2/checkpoints/model.ckpt`
Encoder model frozen.
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/pytorch_lightning/core/saving.py:195: Found keys that are not in the model state dict but in the checkpoint: ['encoder.model.embeddings.position_ids']
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/sc/home/sandeep.uprety/.local/lib/python3.12/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 8_self_correction_evaluation_1.py ...
Using default `ModelCheckpoint`. Consider installing `litmodels` package to enable `LitModelCheckpoint` for automatic upload to the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
