`torch_dtype` is deprecated! Use `dtype` instead!
We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                         | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|████████████▎                                    | 1/4 [00:00<00:01,  1.60it/s]Loading checkpoint shards:  50%|████████████████████████▌                        | 2/4 [00:01<00:01,  1.66it/s]Loading checkpoint shards:  75%|████████████████████████████████████▊            | 3/4 [00:01<00:00,  1.68it/s]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.75it/s]Loading checkpoint shards: 100%|█████████████████████████████████████████████████| 4/4 [00:02<00:00,  1.71it/s]
Generating:   0%|                                                                      | 0/313 [00:00<?, ?it/s]Generating:   0%|▏                                                           | 1/313 [00:12<1:03:55, 12.29s/it]Generating:   1%|▍                                                           | 2/313 [00:24<1:03:03, 12.17s/it]